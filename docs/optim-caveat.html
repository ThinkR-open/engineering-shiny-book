<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 17 Common Application Caveats | Engineering Production-Grade Shiny Apps</title>
  <meta name="description" content="Chapter 17 Common Application Caveats | Engineering Production-Grade Shiny Apps" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 17 Common Application Caveats | Engineering Production-Grade Shiny Apps" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 17 Common Application Caveats | Engineering Production-Grade Shiny Apps" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 17 Common Application Caveats | Engineering Production-Grade Shiny Apps" />
  
  <meta name="twitter:description" content="Chapter 17 Common Application Caveats | Engineering Production-Grade Shiny Apps" />
  

<meta name="author" content="Colin Fay, Vincent Guyader, Cervan Girard, Sébastien Rochette" />


<meta name="date" content="2020-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="when-optimize.html"/>
<link rel="next" href="optimizing-shiny-code.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-149994171-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-149994171-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/thinkr.css" type="text/css" />
<link rel="stylesheet" href="css/style_gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Building Big Shiny Apps - A Workflow</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-structure"><i class="fa fa-check"></i>Book structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#want-to-help"><i class="fa fa-check"></i>Want to help?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other resources</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started-with-shiny"><i class="fa fa-check"></i>Getting started with Shiny</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#shiny-into-production"><i class="fa fa-check"></i>Shiny into production</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors-to-this-book"><i class="fa fa-check"></i>Contributors to this book</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Building Successful Shiny Apps</b></span></li>
<li class="chapter" data-level="1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html"><i class="fa fa-check"></i><b>1</b> About Successful Shiny Apps</a><ul>
<li class="chapter" data-level="1.1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#a-very-short-introduction-to-shiny"><i class="fa fa-check"></i><b>1.1</b> A (very) short introduction to Shiny</a></li>
<li class="chapter" data-level="1.2" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#what-is-a-complex-shiny-application"><i class="fa fa-check"></i><b>1.2</b> What is a complex Shiny Application?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#reaching-the-cliff-of-complexity"><i class="fa fa-check"></i><b>1.2.1</b> Reaching the cliff of complexity</a></li>
<li class="chapter" data-level="1.2.2" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#balancing-complexities"><i class="fa fa-check"></i><b>1.2.2</b> Balancing complexities</a></li>
<li class="chapter" data-level="1.2.3" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#assessing-code-complexity"><i class="fa fa-check"></i><b>1.2.3</b> Assessing code complexity</a></li>
<li class="chapter" data-level="1.2.4" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#production-grade-software-engineering"><i class="fa fa-check"></i><b>1.2.4</b> Production Grade Software Engineering</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#what-is-a-successful-shiny-app"><i class="fa fa-check"></i><b>1.3</b> What is a successful Shiny App?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-exists"><i class="fa fa-check"></i><b>1.3.1</b> It exists</a></li>
<li class="chapter" data-level="1.3.2" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-is-accurate"><i class="fa fa-check"></i><b>1.3.2</b> It is accurate</a></li>
<li class="chapter" data-level="1.3.3" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-is-usable"><i class="fa fa-check"></i><b>1.3.3</b> It is usable</a></li>
<li class="chapter" data-level="1.3.4" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-is-immortal"><i class="fa fa-check"></i><b>1.3.4</b> It is immortal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>2</b> Planning Ahead</a><ul>
<li class="chapter" data-level="2.1" data-path="planning.html"><a href="planning.html#working-with-a-long-term-mindset"><i class="fa fa-check"></i><b>2.1</b> Working with a “long-term” mindset</a><ul>
<li class="chapter" data-level="2.1.1" data-path="planning.html"><a href="planning.html#prepare-for-success"><i class="fa fa-check"></i><b>2.1.1</b> Prepare for success</a></li>
<li class="chapter" data-level="2.1.2" data-path="planning.html"><a href="planning.html#develop-with-the-kiss-principle"><i class="fa fa-check"></i><b>2.1.2</b> Develop with the KISS principle</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="planning.html"><a href="planning.html#working-as-a-team-tools-organisation"><i class="fa fa-check"></i><b>2.2</b> Working as a team: tools &amp; organisation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="planning.html"><a href="planning.html#from-the-tools-point-of-view"><i class="fa fa-check"></i><b>2.2.1</b> From the tools point of view</a></li>
<li class="chapter" data-level="2.2.2" data-path="planning.html"><a href="planning.html#from-the-organisational-point-of-view"><i class="fa fa-check"></i><b>2.2.2</b> From the organisational point of view</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>3</b> Structuring your Project</a><ul>
<li class="chapter" data-level="3.1" data-path="structure.html"><a href="structure.html#shiny-app-as-a-package"><i class="fa fa-check"></i><b>3.1</b> Shiny App as a Package</a><ul>
<li class="chapter" data-level="3.1.1" data-path="structure.html"><a href="structure.html#whats-in-a-shiny-app"><i class="fa fa-check"></i><b>3.1.1</b> What’s in a Shiny App?</a></li>
<li class="chapter" data-level="3.1.2" data-path="structure.html"><a href="structure.html#the-other-plus-side-of-shiny-as-a-package"><i class="fa fa-check"></i><b>3.1.2</b> The other plus side of Shiny as a Package</a></li>
<li class="chapter" data-level="3.1.3" data-path="structure.html"><a href="structure.html#deploy"><i class="fa fa-check"></i><b>3.1.3</b> Deploy</a></li>
<li class="chapter" data-level="3.1.4" data-path="structure.html"><a href="structure.html#resources"><i class="fa fa-check"></i><b>3.1.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="structure.html"><a href="structure.html#using-shiny-modules"><i class="fa fa-check"></i><b>3.2</b> Using Shiny Modules</a><ul>
<li class="chapter" data-level="3.2.1" data-path="structure.html"><a href="structure.html#small-is-beautiful-1"><i class="fa fa-check"></i><b>3.2.1</b> Small is beautiful</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure.html"><a href="structure.html#a-practical-walk-through"><i class="fa fa-check"></i><b>3.2.2</b> A practical walk through</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure.html"><a href="structure.html#communication-between-modules"><i class="fa fa-check"></i><b>3.2.3</b> Communication between modules</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure.html"><a href="structure.html#structuring-your-app"><i class="fa fa-check"></i><b>3.3</b> Structuring your app</a><ul>
<li class="chapter" data-level="3.3.1" data-path="structure.html"><a href="structure.html#business-logic-application-logic"><i class="fa fa-check"></i><b>3.3.1</b> Business logic &amp; application logic</a></li>
<li class="chapter" data-level="3.3.2" data-path="structure.html"><a href="structure.html#small-is-beautiful-bis-repetita"><i class="fa fa-check"></i><b>3.3.2</b> Small is beautiful (bis repetita)</a></li>
<li class="chapter" data-level="3.3.3" data-path="structure.html"><a href="structure.html#conventions-matter"><i class="fa fa-check"></i><b>3.3.3</b> Conventions matter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="golem.html"><a href="golem.html"><i class="fa fa-check"></i><b>4</b> Introduction to <code>{golem}</code></a><ul>
<li class="chapter" data-level="4.1" data-path="golem.html"><a href="golem.html#getting-started-with-golem"><i class="fa fa-check"></i><b>4.1</b> Getting started with <code>{golem}</code></a></li>
<li class="chapter" data-level="4.2" data-path="golem.html"><a href="golem.html#understanding-golem-app-structure"><i class="fa fa-check"></i><b>4.2</b> Understanding <code>{golem}</code> app structure</a><ul>
<li class="chapter" data-level="4.2.1" data-path="golem.html"><a href="golem.html#description-namespace"><i class="fa fa-check"></i><b>4.2.1</b> <code>DESCRIPTION</code> &amp; <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="golem.html"><a href="golem.html#r"><i class="fa fa-check"></i><b>4.2.2</b> R/</a></li>
<li class="chapter" data-level="4.2.3" data-path="golem.html"><a href="golem.html#instappwww"><i class="fa fa-check"></i><b>4.2.3</b> <code>inst/app/www/</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="golem.html"><a href="golem.html#man"><i class="fa fa-check"></i><b>4.2.4</b> <code>man/</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>5</b> The workflow</a><ul>
<li class="chapter" data-level="5.1" data-path="workflow.html"><a href="workflow.html#part-1-design"><i class="fa fa-check"></i><b>5.1</b> Part 1: Design</a></li>
<li class="chapter" data-level="5.2" data-path="workflow.html"><a href="workflow.html#part-2-prototype"><i class="fa fa-check"></i><b>5.2</b> Part 2: Prototype</a></li>
<li class="chapter" data-level="5.3" data-path="workflow.html"><a href="workflow.html#part-3-build"><i class="fa fa-check"></i><b>5.3</b> Part 3: Build</a></li>
<li class="chapter" data-level="5.4" data-path="workflow.html"><a href="workflow.html#part-4-secure"><i class="fa fa-check"></i><b>5.4</b> Part 4: Secure</a></li>
<li class="chapter" data-level="5.5" data-path="workflow.html"><a href="workflow.html#part-5-deploy"><i class="fa fa-check"></i><b>5.5</b> Part 5: Deploy</a></li>
</ul></li>
<li class="part"><span><b>II Step 1: Design</b></span></li>
<li class="chapter" data-level="6" data-path="matters.html"><a href="matters.html"><i class="fa fa-check"></i><b>6</b> UX Matters</a><ul>
<li class="chapter" data-level="6.1" data-path="matters.html"><a href="matters.html#simplicity-is-gold"><i class="fa fa-check"></i><b>6.1</b> Simplicity is Gold</a><ul>
<li class="chapter" data-level="6.1.1" data-path="matters.html"><a href="matters.html#how-we-read-the-web-scanning-content"><i class="fa fa-check"></i><b>6.1.1</b> How we read the web: scanning content</a></li>
<li class="chapter" data-level="6.1.2" data-path="matters.html"><a href="matters.html#a-self-evident-app-or-at-least-self-explanatory"><i class="fa fa-check"></i><b>6.1.2</b> A self-evident app (or at least self-explanatory)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="matters.html"><a href="matters.html#the-danger-of-feature-creep"><i class="fa fa-check"></i><b>6.2</b> The danger of feature-creep</a><ul>
<li class="chapter" data-level="6.2.1" data-path="matters.html"><a href="matters.html#whats-feature-creep"><i class="fa fa-check"></i><b>6.2.1</b> What’s feature-creep?</a></li>
<li class="chapter" data-level="6.2.2" data-path="matters.html"><a href="matters.html#restrain-reactivity"><i class="fa fa-check"></i><b>6.2.2</b> Restrain reactivity</a></li>
<li class="chapter" data-level="6.2.3" data-path="matters.html"><a href="matters.html#too-much-interactivity"><i class="fa fa-check"></i><b>6.2.3</b> Too much interactivity</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="matters.html"><a href="matters.html#web-accessibility"><i class="fa fa-check"></i><b>6.3</b> Web Accessibility</a><ul>
<li class="chapter" data-level="6.3.1" data-path="matters.html"><a href="matters.html#about-accessibility"><i class="fa fa-check"></i><b>6.3.1</b> About Accessibility</a></li>
<li class="chapter" data-level="6.3.2" data-path="matters.html"><a href="matters.html#making-your-app-accessible"><i class="fa fa-check"></i><b>6.3.2</b> Making your App Accessible</a></li>
<li class="chapter" data-level="6.3.3" data-path="matters.html"><a href="matters.html#evaluating-your-app-accessibility-further-reading"><i class="fa fa-check"></i><b>6.3.3</b> Evaluating your App Accessibility &amp; Further reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="step-design.html"><a href="step-design.html"><i class="fa fa-check"></i><b>7</b> Don’t rush into coding</a><ul>
<li class="chapter" data-level="7.1" data-path="step-design.html"><a href="step-design.html#designing-before-coding"><i class="fa fa-check"></i><b>7.1</b> Designing before coding</a><ul>
<li class="chapter" data-level="7.1.1" data-path="step-design.html"><a href="step-design.html#the-urge-to-code"><i class="fa fa-check"></i><b>7.1.1</b> The Urge to Code</a></li>
<li class="chapter" data-level="7.1.2" data-path="step-design.html"><a href="step-design.html#about-concept-map"><i class="fa fa-check"></i><b>7.1.2</b> About Concept Map</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="step-design.html"><a href="step-design.html#ask-questions"><i class="fa fa-check"></i><b>7.2</b> Ask questions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="step-design.html"><a href="step-design.html#about-the-end-users"><i class="fa fa-check"></i><b>7.2.1</b> About the end users</a></li>
<li class="chapter" data-level="7.2.2" data-path="step-design.html"><a href="step-design.html#pre-existing-code-base"><i class="fa fa-check"></i><b>7.2.2</b> Pre-existing code-base</a></li>
<li class="chapter" data-level="7.2.3" data-path="step-design.html"><a href="step-design.html#deployment"><i class="fa fa-check"></i><b>7.2.3</b> Deployment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>8</b> A Gentle Introduction to CSS</a><ul>
<li class="chapter" data-level="8.1" data-path="css.html"><a href="css.html#what-is-css"><i class="fa fa-check"></i><b>8.1</b> What is CSS</a><ul>
<li class="chapter" data-level="8.1.1" data-path="css.html"><a href="css.html#about-css"><i class="fa fa-check"></i><b>8.1.1</b> About CSS</a></li>
<li class="chapter" data-level="8.1.2" data-path="css.html"><a href="css.html#shinys-default-fluidpage"><i class="fa fa-check"></i><b>8.1.2</b> Shiny’s default: <code>fluidPage()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="css.html"><a href="css.html#getting-started-with-css"><i class="fa fa-check"></i><b>8.2</b> Getting started with CSS</a><ul>
<li class="chapter" data-level="8.2.1" data-path="css.html"><a href="css.html#about-css-syntax"><i class="fa fa-check"></i><b>8.2.1</b> About CSS syntax</a></li>
<li class="chapter" data-level="8.2.2" data-path="css.html"><a href="css.html#css-selectors"><i class="fa fa-check"></i><b>8.2.2</b> CSS selectors</a></li>
<li class="chapter" data-level="8.2.3" data-path="css.html"><a href="css.html#css-properties"><i class="fa fa-check"></i><b>8.2.3</b> CSS properties</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="css.html"><a href="css.html#integrate-css-files-to-your-shiny-app"><i class="fa fa-check"></i><b>8.3</b> Integrate CSS files to your Shiny App</a><ul>
<li class="chapter" data-level="8.3.1" data-path="css.html"><a href="css.html#inline-css"><i class="fa fa-check"></i><b>8.3.1</b> Inline CSS</a></li>
<li class="chapter" data-level="8.3.2" data-path="css.html"><a href="css.html#writing-in-a-tagsstyle"><i class="fa fa-check"></i><b>8.3.2</b> Writing in a <code>tags$style()</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="css.html"><a href="css.html#including-external-files"><i class="fa fa-check"></i><b>8.3.3</b> Including External Files</a></li>
<li class="chapter" data-level="8.3.4" data-path="css.html"><a href="css.html#using-r-packages"><i class="fa fa-check"></i><b>8.3.4</b> Using R packages</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="css.html"><a href="css.html#external-resources"><i class="fa fa-check"></i><b>8.4</b> External resources</a></li>
</ul></li>
<li class="part"><span><b>III Step 2: Prototype</b></span></li>
<li class="chapter" data-level="9" data-path="stepprotopype.html"><a href="stepprotopype.html"><i class="fa fa-check"></i><b>9</b> Building an “ipsum-app”</a><ul>
<li class="chapter" data-level="9.1" data-path="stepprotopype.html"><a href="stepprotopype.html#prototyping-is-crucial"><i class="fa fa-check"></i><b>9.1</b> Prototyping is crucial</a><ul>
<li class="chapter" data-level="9.1.1" data-path="stepprotopype.html"><a href="stepprotopype.html#the-ui-first-approach"><i class="fa fa-check"></i><b>9.1.1</b> The “UI first” approach</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="stepprotopype.html"><a href="stepprotopype.html#prototyping-shiny"><i class="fa fa-check"></i><b>9.2</b> Prototyping Shiny</a><ul>
<li class="chapter" data-level="9.2.1" data-path="stepprotopype.html"><a href="stepprotopype.html#fast-prototyping-with-shinipsum"><i class="fa fa-check"></i><b>9.2.1</b> Fast prototyping with <code>{shinipsum}</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="stepprotopype.html"><a href="stepprotopype.html#using-fakir-for-fake-data-generation"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>{fakir}</code> for fake data generation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html"><i class="fa fa-check"></i><b>10</b> Building with RMarkdown</a><ul>
<li class="chapter" data-level="10.1" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html#define-the-content-of-the-application"><i class="fa fa-check"></i><b>10.1</b> Define the content of the application</a></li>
<li class="chapter" data-level="10.2" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html#fill-the-rmd-files"><i class="fa fa-check"></i><b>10.2</b> Fill the Rmd files</a></li>
<li class="chapter" data-level="10.3" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html#use-the-rmd-first-method-to-document-further"><i class="fa fa-check"></i><b>10.3</b> Use the ‘Rmd first’ method to document further</a></li>
</ul></li>
<li class="part"><span><b>IV Step 3: Build</b></span></li>
<li class="chapter" data-level="11" data-path="stepbuild.html"><a href="stepbuild.html"><i class="fa fa-check"></i><b>11</b> Building app with <code>{golem}</code></a><ul>
<li class="chapter" data-level="11.1" data-path="stepbuild.html"><a href="stepbuild.html#using-golem"><i class="fa fa-check"></i><b>11.1</b> Using <code>{golem}</code></a><ul>
<li class="chapter" data-level="11.1.1" data-path="stepbuild.html"><a href="stepbuild.html#create-a-package"><i class="fa fa-check"></i><b>11.1.1</b> Create a package</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="stepbuild.html"><a href="stepbuild.html#dev01_start.r"><i class="fa fa-check"></i><b>11.2</b> <code>dev/01_start.R</code></a><ul>
<li class="chapter" data-level="11.2.1" data-path="stepbuild.html"><a href="stepbuild.html#fill-the-desc"><i class="fa fa-check"></i><b>11.2.1</b> Fill the DESC</a></li>
<li class="chapter" data-level="11.2.2" data-path="stepbuild.html"><a href="stepbuild.html#set-common-files"><i class="fa fa-check"></i><b>11.2.2</b> Set common Files</a></li>
<li class="chapter" data-level="11.2.3" data-path="stepbuild.html"><a href="stepbuild.html#add-a-data-raw-folder"><i class="fa fa-check"></i><b>11.2.3</b> Add a data-raw folder</a></li>
<li class="chapter" data-level="11.2.4" data-path="stepbuild.html"><a href="stepbuild.html#init-tests"><i class="fa fa-check"></i><b>11.2.4</b> Init Tests</a></li>
<li class="chapter" data-level="11.2.5" data-path="stepbuild.html"><a href="stepbuild.html#use-recommended-package"><i class="fa fa-check"></i><b>11.2.5</b> Use Recommended Package</a></li>
<li class="chapter" data-level="11.2.6" data-path="stepbuild.html"><a href="stepbuild.html#add-various-tools"><i class="fa fa-check"></i><b>11.2.6</b> Add various tools</a></li>
<li class="chapter" data-level="11.2.7" data-path="stepbuild.html"><a href="stepbuild.html#if-you-want-to-change-the-default-favicon"><i class="fa fa-check"></i><b>11.2.7</b> If you want to change the default favicon</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="stepbuild.html"><a href="stepbuild.html#day-to-day-dev-with-golem"><i class="fa fa-check"></i><b>11.3</b> Day to Day Dev with <code>{golem}</code></a></li>
<li class="chapter" data-level="11.4" data-path="stepbuild.html"><a href="stepbuild.html#launching-the-app"><i class="fa fa-check"></i><b>11.4</b> Launching the app</a></li>
<li class="chapter" data-level="11.5" data-path="stepbuild.html"><a href="stepbuild.html#dev02_dev.r"><i class="fa fa-check"></i><b>11.5</b> <code>dev/02_dev.R</code></a><ul>
<li class="chapter" data-level="11.5.1" data-path="stepbuild.html"><a href="stepbuild.html#add-modules"><i class="fa fa-check"></i><b>11.5.1</b> Add modules</a></li>
<li class="chapter" data-level="11.5.2" data-path="stepbuild.html"><a href="stepbuild.html#add-dependencies"><i class="fa fa-check"></i><b>11.5.2</b> Add dependencies</a></li>
<li class="chapter" data-level="11.5.3" data-path="stepbuild.html"><a href="stepbuild.html#add-tests"><i class="fa fa-check"></i><b>11.5.3</b> Add tests</a></li>
<li class="chapter" data-level="11.5.4" data-path="stepbuild.html"><a href="stepbuild.html#add-a-browser-button"><i class="fa fa-check"></i><b>11.5.4</b> Add a browser button</a></li>
<li class="chapter" data-level="11.5.5" data-path="stepbuild.html"><a href="stepbuild.html#add-external-files"><i class="fa fa-check"></i><b>11.5.5</b> Add external files</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="stepbuild.html"><a href="stepbuild.html#adding-these-external-resources-to-your-app"><i class="fa fa-check"></i><b>11.6</b> Adding these external resources to your app</a></li>
<li class="chapter" data-level="11.7" data-path="stepbuild.html"><a href="stepbuild.html#documentation"><i class="fa fa-check"></i><b>11.7</b> Documentation</a><ul>
<li class="chapter" data-level="11.7.1" data-path="stepbuild.html"><a href="stepbuild.html#vignette"><i class="fa fa-check"></i><b>11.7.1</b> Vignette</a></li>
<li class="chapter" data-level="11.7.2" data-path="stepbuild.html"><a href="stepbuild.html#code-coverage"><i class="fa fa-check"></i><b>11.7.2</b> Code coverage</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="stepbuild.html"><a href="stepbuild.html#using-golem-dev-functions"><i class="fa fa-check"></i><b>11.8</b> Using <code>{golem}</code> dev functions</a></li>
</ul></li>
<li class="part"><span><b>V Step 4: Strengthen</b></span></li>
<li class="chapter" data-level="12" data-path="step-secure.html"><a href="step-secure.html"><i class="fa fa-check"></i><b>12</b> Build yourself a safety net</a><ul>
<li class="chapter" data-level="12.1" data-path="step-secure.html"><a href="step-secure.html#testing-your-app"><i class="fa fa-check"></i><b>12.1</b> Testing your app</a><ul>
<li class="chapter" data-level="12.1.1" data-path="step-secure.html"><a href="step-secure.html#testing-the-business-logic"><i class="fa fa-check"></i><b>12.1.1</b> Testing the business logic</a></li>
<li class="chapter" data-level="12.1.2" data-path="step-secure.html"><a href="step-secure.html#testing-the-interactive-logic"><i class="fa fa-check"></i><b>12.1.2</b> Testing the interactive logic</a></li>
<li class="chapter" data-level="12.1.3" data-path="step-secure.html"><a href="step-secure.html#testing-the-app-load"><i class="fa fa-check"></i><b>12.1.3</b> Testing the app load</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="step-secure.html"><a href="step-secure.html#a-reproducible-environment"><i class="fa fa-check"></i><b>12.2</b> A reproducible environment</a><ul>
<li class="chapter" data-level="12.2.1" data-path="step-secure.html"><a href="step-secure.html#renv"><i class="fa fa-check"></i><b>12.2.1</b> {renv}</a></li>
<li class="chapter" data-level="12.2.2" data-path="step-secure.html"><a href="step-secure.html#docker-rstudio-connect"><i class="fa fa-check"></i><b>12.2.2</b> Docker &amp; RStudio Connect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="secure.html"><a href="secure.html"><i class="fa fa-check"></i><b>13</b> Version Control</a><ul>
<li class="chapter" data-level="13.1" data-path="secure.html"><a href="secure.html#using-version-control-with-git"><i class="fa fa-check"></i><b>13.1</b> Using Version Control with <code>git</code></a><ul>
<li class="chapter" data-level="13.1.1" data-path="secure.html"><a href="secure.html#why-version-control"><i class="fa fa-check"></i><b>13.1.1</b> Why Version Control?</a></li>
<li class="chapter" data-level="13.1.2" data-path="secure.html"><a href="secure.html#git-basics-commit---push---pull"><i class="fa fa-check"></i><b>13.1.2</b> <code>Git</code> basics: <code>commit</code> - <code>push</code> - <code>pull</code></a></li>
<li class="chapter" data-level="13.1.3" data-path="secure.html"><a href="secure.html#about-branches"><i class="fa fa-check"></i><b>13.1.3</b> About branches</a></li>
<li class="chapter" data-level="13.1.4" data-path="secure.html"><a href="secure.html#issues"><i class="fa fa-check"></i><b>13.1.4</b> Issues</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="secure.html"><a href="secure.html#git-integration"><i class="fa fa-check"></i><b>13.2</b> Git integration</a><ul>
<li class="chapter" data-level="13.2.1" data-path="secure.html"><a href="secure.html#with-rstudio"><i class="fa fa-check"></i><b>13.2.1</b> With RStudio</a></li>
<li class="chapter" data-level="13.2.2" data-path="secure.html"><a href="secure.html#as-part-of-a-larger-world"><i class="fa fa-check"></i><b>13.2.2</b> As part of a larger world</a></li>
<li class="chapter" data-level="13.2.3" data-path="secure.html"><a href="secure.html#about-git-flow"><i class="fa fa-check"></i><b>13.2.3</b> About <code>git-flow</code></a></li>
<li class="chapter" data-level="13.2.4" data-path="secure.html"><a href="secure.html#further-readings-on-git"><i class="fa fa-check"></i><b>13.2.4</b> Further readings on <code>git</code></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="secure.html"><a href="secure.html#ci-and-testing"><i class="fa fa-check"></i><b>13.3</b> CI and testing</a></li>
</ul></li>
<li class="part"><span><b>VI Step 5: Deploy</b></span></li>
<li class="chapter" data-level="14" data-path="stepdeploy.html"><a href="stepdeploy.html"><i class="fa fa-check"></i><b>14</b> Send your app to production</a><ul>
<li class="chapter" data-level="14.1" data-path="stepdeploy.html"><a href="stepdeploy.html#where-to-deploy-your-app"><i class="fa fa-check"></i><b>14.1</b> Where to deploy your app</a></li>
<li class="chapter" data-level="14.2" data-path="stepdeploy.html"><a href="stepdeploy.html#before-deployment-check-list"><i class="fa fa-check"></i><b>14.2</b> Before deployment Check-list</a><ul>
<li class="chapter" data-level="14.2.1" data-path="stepdeploy.html"><a href="stepdeploy.html#what-to-check-on-the-app"><i class="fa fa-check"></i><b>14.2.1</b> What to check on the app</a></li>
<li class="chapter" data-level="14.2.2" data-path="stepdeploy.html"><a href="stepdeploy.html#what-to-check-in-the-production-envionment"><i class="fa fa-check"></i><b>14.2.2</b> What to check in the production envionment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="deploy-golem.html"><a href="deploy-golem.html"><i class="fa fa-check"></i><b>15</b> Deploy with <code>{golem}</code></a><ul>
<li class="chapter" data-level="15.1" data-path="deploy-golem.html"><a href="deploy-golem.html#local-deployment-1"><i class="fa fa-check"></i><b>15.1</b> Local deployment</a></li>
<li class="chapter" data-level="15.2" data-path="deploy-golem.html"><a href="deploy-golem.html#deploying-apps-with-golem"><i class="fa fa-check"></i><b>15.2</b> Deploying Apps with <code>{golem}</code></a></li>
<li class="chapter" data-level="15.3" data-path="deploy-golem.html"><a href="deploy-golem.html#rstudio-environments"><i class="fa fa-check"></i><b>15.3</b> RStudio Environments</a></li>
<li class="chapter" data-level="15.4" data-path="deploy-golem.html"><a href="deploy-golem.html#docker"><i class="fa fa-check"></i><b>15.4</b> Docker</a></li>
</ul></li>
<li class="part"><span><b>VII Optimizing</b></span></li>
<li class="chapter" data-level="16" data-path="when-optimize.html"><a href="when-optimize.html"><i class="fa fa-check"></i><b>16</b> The Need for Optimization</a><ul>
<li class="chapter" data-level="16.1" data-path="when-optimize.html"><a href="when-optimize.html#build-first-then-optimize"><i class="fa fa-check"></i><b>16.1</b> Build first, then optimize</a><ul>
<li class="chapter" data-level="16.1.1" data-path="when-optimize.html"><a href="when-optimize.html#identifying-bottlenecks"><i class="fa fa-check"></i><b>16.1.1</b> Identifying bottlenecks</a></li>
<li class="chapter" data-level="16.1.2" data-path="when-optimize.html"><a href="when-optimize.html#do-you-need-faster-functions"><i class="fa fa-check"></i><b>16.1.2</b> Do you need faster functions?</a></li>
<li class="chapter" data-level="16.1.3" data-path="when-optimize.html"><a href="when-optimize.html#dont-sacrifice-readability"><i class="fa fa-check"></i><b>16.1.3</b> Don’t sacrifice readability</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="when-optimize.html"><a href="when-optimize.html#tools-for-profiling"><i class="fa fa-check"></i><b>16.2</b> Tools for profiling</a><ul>
<li class="chapter" data-level="16.2.1" data-path="when-optimize.html"><a href="when-optimize.html#profiling-r-code"><i class="fa fa-check"></i><b>16.2.1</b> Profiling R code</a></li>
<li class="chapter" data-level="16.2.2" data-path="when-optimize.html"><a href="when-optimize.html#profiling-shiny"><i class="fa fa-check"></i><b>16.2.2</b> Profiling Shiny</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="optim-caveat.html"><a href="optim-caveat.html"><i class="fa fa-check"></i><b>17</b> Common Application Caveats</a><ul>
<li class="chapter" data-level="17.1" data-path="optim-caveat.html"><a href="optim-caveat.html#reactivity-anti-patterns"><i class="fa fa-check"></i><b>17.1</b> Reactivity anti-patterns</a><ul>
<li class="chapter" data-level="17.1.1" data-path="optim-caveat.html"><a href="optim-caveat.html#reactivity-is-awesome-until-its-not"><i class="fa fa-check"></i><b>17.1.1</b> Reactivity is awesome… until it’s not</a></li>
<li class="chapter" data-level="17.1.2" data-path="optim-caveat.html"><a href="optim-caveat.html#observe-vs-observeevent"><i class="fa fa-check"></i><b>17.1.2</b> <code>observe</code> vs <code>observeEvent</code></a></li>
<li class="chapter" data-level="17.1.3" data-path="optim-caveat.html"><a href="optim-caveat.html#building-triggers-and-watchers"><i class="fa fa-check"></i><b>17.1.3</b> Building triggers and watchers</a></li>
<li class="chapter" data-level="17.1.4" data-path="optim-caveat.html"><a href="optim-caveat.html#using-r6-as-a-data-storage"><i class="fa fa-check"></i><b>17.1.4</b> Using R6 as a data storage</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="optim-caveat.html"><a href="optim-caveat.html#r-does-too-much"><i class="fa fa-check"></i><b>17.2</b> R does too much</a></li>
<li class="chapter" data-level="17.3" data-path="optim-caveat.html"><a href="optim-caveat.html#reading-data"><i class="fa fa-check"></i><b>17.3</b> Reading data</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html"><i class="fa fa-check"></i><b>18</b> Optimizing Shiny Code</a><ul>
<li class="chapter" data-level="18.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#optimizing-r-code"><i class="fa fa-check"></i><b>18.1</b> Optimizing R code</a></li>
<li class="chapter" data-level="18.2" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#caching-elements"><i class="fa fa-check"></i><b>18.2</b> Caching elements</a><ul>
<li class="chapter" data-level="18.2.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#whats-caching"><i class="fa fa-check"></i><b>18.2.1</b> What’s caching?</a></li>
<li class="chapter" data-level="18.2.2" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#using-caching-in-r"><i class="fa fa-check"></i><b>18.2.2</b> Using caching in R</a></li>
<li class="chapter" data-level="18.2.3" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#caching-shiny"><i class="fa fa-check"></i><b>18.2.3</b> Caching Shiny</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#paralellizing-shiny"><i class="fa fa-check"></i><b>18.3</b> Paralellizing Shiny</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="optimjs.html"><a href="optimjs.html"><i class="fa fa-check"></i><b>19</b> Using JavaScript</a><ul>
<li class="chapter" data-level="19.1" data-path="optimjs.html"><a href="optimjs.html#a-quick-introduction-to-javascript"><i class="fa fa-check"></i><b>19.1</b> A quick introduction to JavaScript</a><ul>
<li class="chapter" data-level="19.1.1" data-path="optimjs.html"><a href="optimjs.html#understanding-html-class-and-id"><i class="fa fa-check"></i><b>19.1.1</b> Understanding html, class, and id</a></li>
<li class="chapter" data-level="19.1.2" data-path="optimjs.html"><a href="optimjs.html#about-jquery-jquery-selectors"><i class="fa fa-check"></i><b>19.1.2</b> About jQuery &amp; jQuery selectors</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="optimjs.html"><a href="optimjs.html#client-side-javascript"><i class="fa fa-check"></i><b>19.2</b> Client-side JavaScript</a><ul>
<li class="chapter" data-level="19.2.1" data-path="optimjs.html"><a href="optimjs.html#common-patterns"><i class="fa fa-check"></i><b>19.2.1</b> Common patterns</a></li>
<li class="chapter" data-level="19.2.2" data-path="optimjs.html"><a href="optimjs.html#where-to-put-them---introduction-to-javascript-events"><i class="fa fa-check"></i><b>19.2.2</b> Where to put them - introduction to JavaScript events</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="optimjs.html"><a href="optimjs.html#javascript---shiny-communication"><i class="fa fa-check"></i><b>19.3</b> JavaScript &lt;-&gt; Shiny communication</a><ul>
<li class="chapter" data-level="19.3.1" data-path="optimjs.html"><a href="optimjs.html#from-r-to-javascript"><i class="fa fa-check"></i><b>19.3.1</b> From R to JavaScript</a></li>
<li class="chapter" data-level="19.3.2" data-path="optimjs.html"><a href="optimjs.html#from-javascript-to-r"><i class="fa fa-check"></i><b>19.3.2</b> From JavaScript to R</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="optimjs.html"><a href="optimjs.html#about-golem-js-functions"><i class="fa fa-check"></i><b>19.4</b> About <code>{golem}</code> js functions</a><ul>
<li class="chapter" data-level="19.4.1" data-path="optimjs.html"><a href="optimjs.html#goleminvoke_js"><i class="fa fa-check"></i><b>19.4.1</b> <code>golem::invoke_js()</code></a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="optimjs.html"><a href="optimjs.html#learn-more-about-javascript"><i class="fa fa-check"></i><b>19.5</b> Learn more about JavaScript</a><ul>
<li class="chapter" data-level="19.5.1" data-path="optimjs.html"><a href="optimjs.html#javascript-basics"><i class="fa fa-check"></i><b>19.5.1</b> JavaScript basics</a></li>
<li class="chapter" data-level="19.5.2" data-path="optimjs.html"><a href="optimjs.html#jquery"><i class="fa fa-check"></i><b>19.5.2</b> jQuery</a></li>
<li class="chapter" data-level="19.5.3" data-path="optimjs.html"><a href="optimjs.html#intermediate-advanced-javascript"><i class="fa fa-check"></i><b>19.5.3</b> Intermediate / advanced JavaScript</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://rtask.thinkr.fr">A book by the ThinkR team</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Engineering Production-Grade Shiny Apps</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="optim-caveat" class="section level1">
<h1><span class="header-section-number">Chapter 17</span> Common Application Caveats</h1>
<div id="reactivity-anti-patterns" class="section level2">
<h2><span class="header-section-number">17.1</span> Reactivity anti-patterns</h2>
<div id="reactivity-is-awesome-until-its-not" class="section level3">
<h3><span class="header-section-number">17.1.1</span> Reactivity is awesome… until it’s not</h3>
<p>Let’s face it, reactivity is awesome… until it’s not.
Reactivity is a common source of confusion for beginners, and a common source of bugs and bottlenecks, even for seasoned Shiny developers.
Most of the time, issues come from the fact that <strong>there is too much reactivity</strong>, i.e. we build apps where too much things happen, and some things are updated way more than they should, and computations are performed when they shouldn’t.</p>
<p>Of course, it’s a nice feature to make everything react instantly to changes, but when building larger apps it’s easy to create monsters, i.e complicated, messy reactive graphs where everything is updated too much and too often.
Or worse, we generate endless reactive loops.</p>
<p>And the more you work on your app, the more complex it gets, and the more you’ll be likely to end up in the reactive inferno.
In this section, we’ll be speaking a little bit about reactivity and how to have more control on it, and about a way to share data across modules without relying on passing along reactive objects.</p>
</div>
<div id="observe-vs-observeevent" class="section level3">
<h3><span class="header-section-number">17.1.2</span> <code>observe</code> vs <code>observeEvent</code></h3>
<p>One of the most common feature of reactive inferno is the use of <code>observe()</code> in cases where you should use <code>observeEvent</code>.
Spoiler: you should try to use <code>observeEvent()</code> as much as possible, and avoid <code>observe()</code>as much as possible.
At first, <code>observe()</code> seems easier to implement, and feels like a shortcut as you don’t have to think about what to react to: everything gets updated without you thinking about it.
But the truth is that this stairway doesn’t lead to heaven.</p>
<p>Let’s stop and think about <code>observe()</code> for a minute.
This function updates <strong>every time a reactive object it contains is invalidated</strong>. Y
es, this works well if you have a small amount of reactive objects in the observer, but that gets tricky whenever you start adding things inside your <code>observe()</code>, as you might be launching a computation 10 times if your reactive scope contains 10 reactive objects that are somehow invalidated in chain.
And believe me, we’ve seen pieces of code where the <code>observe()</code> contains hundreds of lines of code, with reactives objects all over the place.</p>
<p>For example, let’s start with that:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="co">## DON&#39;T DO GLOBAL VARIABLES, IT&#39;S JUST TO SIMPLIFY THE EXAMPLE</span></a>
<a class="sourceLine" id="cb120-2" title="2">i &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb120-3" title="3"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb120-4" title="4"><span class="kw">library</span>(cli)</a>
<a class="sourceLine" id="cb120-5" title="5">ui &lt;-<span class="st"> </span><span class="cf">function</span>(request){</a>
<a class="sourceLine" id="cb120-6" title="6">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb120-7" title="7">    <span class="kw">textInput</span>(<span class="st">&quot;txt&quot;</span>, <span class="st">&quot;txt&quot;</span>)</a>
<a class="sourceLine" id="cb120-8" title="8">  )</a>
<a class="sourceLine" id="cb120-9" title="9">}</a>
<a class="sourceLine" id="cb120-10" title="10"></a>
<a class="sourceLine" id="cb120-11" title="11">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</a>
<a class="sourceLine" id="cb120-12" title="12">  <span class="kw">observe</span>({</a>
<a class="sourceLine" id="cb120-13" title="13">    i &lt;&lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb120-14" title="14">    <span class="kw">cat_rule</span>(<span class="kw">as.character</span>(i))</a>
<a class="sourceLine" id="cb120-15" title="15">    <span class="kw">print</span>(input<span class="op">$</span>txt)</a>
<a class="sourceLine" id="cb120-16" title="16">  })</a>
<a class="sourceLine" id="cb120-17" title="17">}</a>
<a class="sourceLine" id="cb120-18" title="18"></a>
<a class="sourceLine" id="cb120-19" title="19"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>Oh, and then, let’s add a small selectInput</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">i &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb121-2" title="2"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb121-3" title="3"><span class="kw">library</span>(cli)</a>
<a class="sourceLine" id="cb121-4" title="4">ui &lt;-<span class="st"> </span><span class="cf">function</span>(request){</a>
<a class="sourceLine" id="cb121-5" title="5">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb121-6" title="6">    <span class="kw">textInput</span>(<span class="st">&quot;txt&quot;</span>, <span class="st">&quot;txt&quot;</span>), </a>
<a class="sourceLine" id="cb121-7" title="7">    <span class="kw">selectInput</span>(<span class="st">&quot;tolower&quot;</span>, <span class="st">&quot;casse&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>))</a>
<a class="sourceLine" id="cb121-8" title="8">  )</a>
<a class="sourceLine" id="cb121-9" title="9">}</a>
<a class="sourceLine" id="cb121-10" title="10"></a>
<a class="sourceLine" id="cb121-11" title="11">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</a>
<a class="sourceLine" id="cb121-12" title="12">  <span class="kw">observe</span>({</a>
<a class="sourceLine" id="cb121-13" title="13">    i &lt;&lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb121-14" title="14">    <span class="kw">cat_rule</span>(<span class="kw">as.character</span>(i))</a>
<a class="sourceLine" id="cb121-15" title="15">    <span class="cf">if</span> (input<span class="op">$</span>tolower <span class="op">==</span><span class="st"> &quot;lower&quot;</span>) {</a>
<a class="sourceLine" id="cb121-16" title="16">      <span class="kw">print</span>(<span class="kw">tolower</span>(input<span class="op">$</span>txt))</a>
<a class="sourceLine" id="cb121-17" title="17">    } <span class="cf">else</span>  {</a>
<a class="sourceLine" id="cb121-18" title="18">      <span class="kw">print</span>(<span class="kw">tolower</span>(input<span class="op">$</span>txt))</a>
<a class="sourceLine" id="cb121-19" title="19">    }</a>
<a class="sourceLine" id="cb121-20" title="20">  })</a>
<a class="sourceLine" id="cb121-21" title="21">}</a>
<a class="sourceLine" id="cb121-22" title="22"></a>
<a class="sourceLine" id="cb121-23" title="23"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>And, as time goes by, we add another control flow to our <code>observe()</code>:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">i &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb122-3" title="3"><span class="kw">library</span>(cli)</a>
<a class="sourceLine" id="cb122-4" title="4"><span class="kw">library</span>(stringi)</a>
<a class="sourceLine" id="cb122-5" title="5">ui &lt;-<span class="st"> </span><span class="cf">function</span>(request){</a>
<a class="sourceLine" id="cb122-6" title="6">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb122-7" title="7">    <span class="kw">textInput</span>(<span class="st">&quot;txt&quot;</span>, <span class="st">&quot;txt&quot;</span>), </a>
<a class="sourceLine" id="cb122-8" title="8">    <span class="kw">selectInput</span>(<span class="st">&quot;tolower&quot;</span>, <span class="st">&quot;casse&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>)), </a>
<a class="sourceLine" id="cb122-9" title="9">    <span class="kw">checkboxInput</span>(<span class="st">&quot;rev&quot;</span>, <span class="st">&quot;reverse&quot;</span>)</a>
<a class="sourceLine" id="cb122-10" title="10">  )</a>
<a class="sourceLine" id="cb122-11" title="11">}</a>
<a class="sourceLine" id="cb122-12" title="12"></a>
<a class="sourceLine" id="cb122-13" title="13">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</a>
<a class="sourceLine" id="cb122-14" title="14">  <span class="kw">observe</span>({</a>
<a class="sourceLine" id="cb122-15" title="15">    i &lt;&lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb122-16" title="16">    <span class="kw">cat_rule</span>(<span class="kw">as.character</span>(i))</a>
<a class="sourceLine" id="cb122-17" title="17">    <span class="cf">if</span> (input<span class="op">$</span>rev){</a>
<a class="sourceLine" id="cb122-18" title="18">      x &lt;-<span class="st"> </span><span class="kw">stri_reverse</span>(input<span class="op">$</span>txt)</a>
<a class="sourceLine" id="cb122-19" title="19">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb122-20" title="20">      x &lt;-<span class="st"> </span>input<span class="op">$</span>txt</a>
<a class="sourceLine" id="cb122-21" title="21">    }</a>
<a class="sourceLine" id="cb122-22" title="22">    <span class="cf">if</span> (input<span class="op">$</span>tolower <span class="op">==</span><span class="st"> &quot;lower&quot;</span>){</a>
<a class="sourceLine" id="cb122-23" title="23">      <span class="kw">print</span>(<span class="kw">tolower</span>(x))</a>
<a class="sourceLine" id="cb122-24" title="24">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb122-25" title="25">      <span class="kw">print</span>(<span class="kw">tolower</span>(x))</a>
<a class="sourceLine" id="cb122-26" title="26">    }</a>
<a class="sourceLine" id="cb122-27" title="27">  })</a>
<a class="sourceLine" id="cb122-28" title="28">}</a>
<a class="sourceLine" id="cb122-29" title="29"></a>
<a class="sourceLine" id="cb122-30" title="30"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>And it would be nice to keep the selected values into a reactive list, so that we can reuse it elsewhere.
And maybe you would like to add a checkbox so that the logs are printed to the console only if checked.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">i &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="kw">library</span>(cli)</a>
<a class="sourceLine" id="cb123-4" title="4"><span class="kw">library</span>(stringi)</a>
<a class="sourceLine" id="cb123-5" title="5">ui &lt;-<span class="st"> </span><span class="cf">function</span>(request){</a>
<a class="sourceLine" id="cb123-6" title="6">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb123-7" title="7">    <span class="kw">textInput</span>(<span class="st">&quot;txt&quot;</span>, <span class="st">&quot;txt&quot;</span>), </a>
<a class="sourceLine" id="cb123-8" title="8">    <span class="kw">selectInput</span>(<span class="st">&quot;tolower&quot;</span>, <span class="st">&quot;casse&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;lower&quot;</span>, <span class="st">&quot;upper&quot;</span>)), </a>
<a class="sourceLine" id="cb123-9" title="9">    <span class="kw">checkboxInput</span>(<span class="st">&quot;rev&quot;</span>, <span class="st">&quot;reverse&quot;</span>)</a>
<a class="sourceLine" id="cb123-10" title="10">  )</a>
<a class="sourceLine" id="cb123-11" title="11">}</a>
<a class="sourceLine" id="cb123-12" title="12"></a>
<a class="sourceLine" id="cb123-13" title="13">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</a>
<a class="sourceLine" id="cb123-14" title="14">  r &lt;-<span class="st"> </span><span class="kw">reactiveValues</span>()</a>
<a class="sourceLine" id="cb123-15" title="15">  <span class="kw">observe</span>({</a>
<a class="sourceLine" id="cb123-16" title="16">    i &lt;&lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb123-17" title="17">    <span class="kw">cat_rule</span>(<span class="kw">as.character</span>(i))</a>
<a class="sourceLine" id="cb123-18" title="18">    <span class="cf">if</span> (input<span class="op">$</span>rev) {</a>
<a class="sourceLine" id="cb123-19" title="19">      r<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">stri_reverse</span>(input<span class="op">$</span>txt) </a>
<a class="sourceLine" id="cb123-20" title="20">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb123-21" title="21">      r<span class="op">$</span>x &lt;-<span class="st"> </span>input<span class="op">$</span>txt</a>
<a class="sourceLine" id="cb123-22" title="22">    }</a>
<a class="sourceLine" id="cb123-23" title="23">    <span class="cf">if</span> (input<span class="op">$</span>tolower <span class="op">==</span><span class="st"> &quot;lower&quot;</span>){</a>
<a class="sourceLine" id="cb123-24" title="24">      r<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">tolower</span>(r<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb123-25" title="25">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb123-26" title="26">      r<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">toupper</span>(r<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb123-27" title="27">    }</a>
<a class="sourceLine" id="cb123-28" title="28">  })</a>
<a class="sourceLine" id="cb123-29" title="29">}</a>
<a class="sourceLine" id="cb123-30" title="30"></a>
<a class="sourceLine" id="cb123-31" title="31"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>Ok, now can you tell how many potential invalidation points we’ve got here?
Three: whenever <code>input$txt</code>, <code>input$rev</code> or <code>input$tolower</code> change.
Of course, three is not that much, but you get the idea.</p>
<p>Let’s pause a minute and think about why we use <code>observe()</code> here.
To update the values inside <code>r$x</code>, yes.
But do we need to use <code>observe()</code> for, say, updating <code>r$x</code> under dozens of conditions, each time the user types a letter?
I don’t think so.</p>
<p>We generally want our observer to update its content under a small, controlled number of inputs, i.e. with a controlled number of invalidation points.
And, what we often forget is that users don’t type/select correctly on the first try.
No, they usually try and miss, restart, change things, amplifying the reactivity “over-happening”.</p>
<p>Moreover, long <code>observe()</code> statements are hard to debug, and they make collaboration harder when the trigger to the observe logic can potentially lives anywhere between line one and line 257 of your <code>observe()</code>. That’s why (well, in 99% of cases), it’s safer to go with <code>observeEvent</code>, as it allows to see at a glanche what are the condition under which the content is invalidated and re-evalutaed.
Then, if a reactive context is invalidated, <strong>you know why</strong>.</p>
</div>
<div id="building-triggers-and-watchers" class="section level3">
<h3><span class="header-section-number">17.1.3</span> Building triggers and watchers</h3>
<p>// TODO</p>
<p>So the general pattern is that one: we create “flags” with an <code>init</code> function, trigger these “flags” with <code>trigger()</code>, and wherever we want these flags to invalidate the reactive context, we <code>watch()</code> these flags.</p>
<p>The idea here is to get a full control over the reactive flow: we only invalidate contexts when we want, making the general flow of the app more predictable.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">init &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()){</a>
<a class="sourceLine" id="cb124-2" title="2">  session<span class="op">$</span>userData[[name]] &lt;-<span class="st"> </span><span class="kw">reactiveVal</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb124-3" title="3">}</a>
<a class="sourceLine" id="cb124-4" title="4"></a>
<a class="sourceLine" id="cb124-5" title="5">trigger &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()){</a>
<a class="sourceLine" id="cb124-6" title="6">  session<span class="op">$</span>userData[[name]](</a>
<a class="sourceLine" id="cb124-7" title="7">    session<span class="op">$</span>userData[[name]]() <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb124-8" title="8">  )</a>
<a class="sourceLine" id="cb124-9" title="9">}</a>
<a class="sourceLine" id="cb124-10" title="10"></a>
<a class="sourceLine" id="cb124-11" title="11">watch &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">session =</span> <span class="kw">getDefaultReactiveDomain</span>()){</a>
<a class="sourceLine" id="cb124-12" title="12">  session<span class="op">$</span>userData[[name]]()</a>
<a class="sourceLine" id="cb124-13" title="13">}</a></code></pre></div>
<p>And, bonus, as these functions use the <code>session</code> object, they are available across all modules. That also means that you can easily trigger an event inside a model from another one.</p>
</div>
<div id="using-r6-as-a-data-storage" class="section level3">
<h3><span class="header-section-number">17.1.4</span> Using R6 as a data storage</h3>
<p>One pattern we’ve also been playing with is storing the app business logic inside of one or more R6 objects.
Why would we want to do that?</p>
<div id="sharing-data-accross-module" class="section level4">
<h4><span class="header-section-number">17.1.4.1</span> Sharing data accross module</h4>
<p>Sharing an R6 object makes it simpler but without the complexity of sharing &amp; handling reactive objects.</p>
<p>So basically, the idea is to hold the whole logic of your data reading / cleaning / processing / outputing inside an R6 class.
You’ll then initiate an instance of this class, then pass this object through your modules and submodules.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">nameui &lt;-<span class="st"> </span><span class="cf">function</span>(id){</a>
<a class="sourceLine" id="cb125-2" title="2">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb125-3" title="3">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb125-4" title="4">    <span class="co"># [...]</span></a>
<a class="sourceLine" id="cb125-5" title="5">  )</a>
<a class="sourceLine" id="cb125-6" title="6">}</a>
<a class="sourceLine" id="cb125-7" title="7"></a>
<a class="sourceLine" id="cb125-8" title="8">name &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session, obj){</a>
<a class="sourceLine" id="cb125-9" title="9">  ns &lt;-<span class="st"> </span>session<span class="op">$</span>ns</a>
<a class="sourceLine" id="cb125-10" title="10">  output<span class="op">$</span>that &lt;-<span class="st"> </span><span class="kw">renderThis</span>({</a>
<a class="sourceLine" id="cb125-11" title="11">    obj<span class="op">$</span><span class="kw">compute</span>()</a>
<a class="sourceLine" id="cb125-12" title="12">  })</a>
<a class="sourceLine" id="cb125-13" title="13">}</a>
<a class="sourceLine" id="cb125-14" title="14"></a>
<a class="sourceLine" id="cb125-15" title="15"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb125-16" title="16">ui &lt;-<span class="st"> </span><span class="cf">function</span>(request){</a>
<a class="sourceLine" id="cb125-17" title="17">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb125-18" title="18">    <span class="kw">nameui</span>(<span class="st">&quot;nameui&quot;</span>)</a>
<a class="sourceLine" id="cb125-19" title="19">  )</a>
<a class="sourceLine" id="cb125-20" title="20">}</a>
<a class="sourceLine" id="cb125-21" title="21"></a>
<a class="sourceLine" id="cb125-22" title="22">server &lt;-<span class="st"> </span><span class="cf">function</span>(</a>
<a class="sourceLine" id="cb125-23" title="23">  input, </a>
<a class="sourceLine" id="cb125-24" title="24">  output, </a>
<a class="sourceLine" id="cb125-25" title="25">  session</a>
<a class="sourceLine" id="cb125-26" title="26">){</a>
<a class="sourceLine" id="cb125-27" title="27">  obj &lt;-<span class="st"> </span>MyDataProcess<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb125-28" title="28">  <span class="kw">callModule</span>(name, <span class="st">&quot;nameui&quot;</span>, obj)</a>
<a class="sourceLine" id="cb125-29" title="29">  </a>
<a class="sourceLine" id="cb125-30" title="30">}</a>
<a class="sourceLine" id="cb125-31" title="31"></a>
<a class="sourceLine" id="cb125-32" title="32"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>Of course, this makes sense if you’re combining it with the trigger / watch from before :)</p>
</div>
<div id="get-sure-its-tested" class="section level4">
<h4><span class="header-section-number">17.1.4.2</span> Get sure it’s tested</h4>
<p>During the process of building a robust Shiny app, we strongly suggest that you test as many things as you can.
This is where using an R6 for your business logic of your app makes sense: this allows you to build the whole testing of your application logic outside of any reactive context: you simply build unit tests just as any other function.</p>
</div>
</div>
</div>
<div id="r-does-too-much" class="section level2">
<h2><span class="header-section-number">17.2</span> R does too much</h2>
<p>// TODO</p>
</div>
<div id="reading-data" class="section level2">
<h2><span class="header-section-number">17.3</span> Reading data</h2>
<p>// TODO</p>

</div>
</div>
<hr/>
<footer>
<a href="rtask.thinkr.fr"><img src="img/logo400_129.png" alt="ThinkR Website"/></a>
</footer>
            </section>

          </div>
        </div>
      </div>
<a href="when-optimize.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimizing-shiny-code.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ThinkR-open/building-shiny-apps-workflow/edit/master/common-app-caveats.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
