<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Structuring your Project | Engineering Production-Grade Shiny Apps</title>
  <meta name="description" content="Chapter 3 Structuring your Project | Engineering Production-Grade Shiny Apps" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Structuring your Project | Engineering Production-Grade Shiny Apps" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 3 Structuring your Project | Engineering Production-Grade Shiny Apps" />
  <meta name="github-repo" content="ThinkR-open/building-shiny-apps-workflow" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Structuring your Project | Engineering Production-Grade Shiny Apps" />
  
  <meta name="twitter:description" content="Chapter 3 Structuring your Project | Engineering Production-Grade Shiny Apps" />
  

<meta name="author" content="Colin Fay, Vincent Guyader, Cervan Girard, Sébastien Rochette" />


<meta name="date" content="2020-03-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="planning.html"/>
<link rel="next" href="golem.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-149994171-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-149994171-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/thinkr.css" type="text/css" />
<link rel="stylesheet" href="css/style_gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Engineering Production-Grade Shiny Apps</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-structure"><i class="fa fa-check"></i>Book structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#want-to-help"><i class="fa fa-check"></i>Want to help?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other resources</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started-with-shiny"><i class="fa fa-check"></i>Getting started with Shiny</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#shiny-into-production"><i class="fa fa-check"></i>Shiny into production</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors-to-this-book"><i class="fa fa-check"></i>Contributors to this book</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Building Successful Shiny Apps</b></span></li>
<li class="chapter" data-level="1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html"><i class="fa fa-check"></i><b>1</b> About Successful Shiny Apps</a><ul>
<li class="chapter" data-level="1.1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#a-very-short-introduction-to-shiny"><i class="fa fa-check"></i><b>1.1</b> A (very) short introduction to Shiny</a></li>
<li class="chapter" data-level="1.2" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#complex-shiny"><i class="fa fa-check"></i><b>1.2</b> What is a complex Shiny Application?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#reaching-the-cliff-of-complexity"><i class="fa fa-check"></i><b>1.2.1</b> Reaching the cliff of complexity</a></li>
<li class="chapter" data-level="1.2.2" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#balancing-complexities"><i class="fa fa-check"></i><b>1.2.2</b> Balancing complexities</a></li>
<li class="chapter" data-level="1.2.3" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#assessing-code-complexity"><i class="fa fa-check"></i><b>1.2.3</b> Assessing code complexity</a></li>
<li class="chapter" data-level="1.2.4" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#production-grade-software-engineering"><i class="fa fa-check"></i><b>1.2.4</b> Production Grade Software Engineering</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#what-is-a-successful-shiny-app"><i class="fa fa-check"></i><b>1.3</b> What is a successful Shiny App?</a><ul>
<li class="chapter" data-level="1.3.1" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-exists"><i class="fa fa-check"></i><b>1.3.1</b> It exists</a></li>
<li class="chapter" data-level="1.3.2" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-is-accurate"><i class="fa fa-check"></i><b>1.3.2</b> It is accurate</a></li>
<li class="chapter" data-level="1.3.3" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-is-usable"><i class="fa fa-check"></i><b>1.3.3</b> It is usable</a></li>
<li class="chapter" data-level="1.3.4" data-path="successfulshinyapp.html"><a href="successfulshinyapp.html#it-is-immortal"><i class="fa fa-check"></i><b>1.3.4</b> It is immortal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="planning.html"><a href="planning.html"><i class="fa fa-check"></i><b>2</b> Planning Ahead</a><ul>
<li class="chapter" data-level="2.1" data-path="planning.html"><a href="planning.html#working-with-a-long-term-mindset"><i class="fa fa-check"></i><b>2.1</b> Working with a “long-term” mindset</a><ul>
<li class="chapter" data-level="2.1.1" data-path="planning.html"><a href="planning.html#prepare-for-success"><i class="fa fa-check"></i><b>2.1.1</b> Prepare for success</a></li>
<li class="chapter" data-level="2.1.2" data-path="planning.html"><a href="planning.html#develop-with-the-kiss-principle"><i class="fa fa-check"></i><b>2.1.2</b> Develop with the KISS principle</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="planning.html"><a href="planning.html#working-as-a-team-tools-organisation"><i class="fa fa-check"></i><b>2.2</b> Working as a team: tools &amp; organisation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="planning.html"><a href="planning.html#from-the-tools-point-of-view"><i class="fa fa-check"></i><b>2.2.1</b> From the tools point of view</a></li>
<li class="chapter" data-level="2.2.2" data-path="planning.html"><a href="planning.html#from-the-organisational-point-of-view"><i class="fa fa-check"></i><b>2.2.2</b> From the organisational point of view</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>3</b> Structuring your Project</a><ul>
<li class="chapter" data-level="3.1" data-path="structure.html"><a href="structure.html#shiny-app-as-a-package"><i class="fa fa-check"></i><b>3.1</b> Shiny App as a Package</a><ul>
<li class="chapter" data-level="3.1.1" data-path="structure.html"><a href="structure.html#what-is-your-organisation-for-a-shiny-app-project"><i class="fa fa-check"></i><b>3.1.1</b> What is your organisation for a Shiny App project?</a></li>
<li class="chapter" data-level="3.1.2" data-path="structure.html"><a href="structure.html#document-and-test"><i class="fa fa-check"></i><b>3.1.2</b> Document and test</a></li>
<li class="chapter" data-level="3.1.3" data-path="structure.html"><a href="structure.html#deploy"><i class="fa fa-check"></i><b>3.1.3</b> Deploy</a></li>
<li class="chapter" data-level="3.1.4" data-path="structure.html"><a href="structure.html#resources"><i class="fa fa-check"></i><b>3.1.4</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="structure.html"><a href="structure.html#using-shiny-modules"><i class="fa fa-check"></i><b>3.2</b> Using Shiny Modules</a><ul>
<li class="chapter" data-level="3.2.1" data-path="structure.html"><a href="structure.html#why-are-we-using-shiny-modules"><i class="fa fa-check"></i><b>3.2.1</b> Why are we using Shiny modules?</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure.html"><a href="structure.html#when-should-you-modularize"><i class="fa fa-check"></i><b>3.2.2</b> When should you modularize?</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure.html"><a href="structure.html#a-practical-walk-through"><i class="fa fa-check"></i><b>3.2.3</b> A practical walk through</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure.html"><a href="structure.html#communication-between-modules"><i class="fa fa-check"></i><b>3.2.4</b> Communication between modules</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure.html"><a href="structure.html#structuring-your-app"><i class="fa fa-check"></i><b>3.3</b> Structuring your app</a><ul>
<li class="chapter" data-level="3.3.1" data-path="structure.html"><a href="structure.html#business-logic-application-logic"><i class="fa fa-check"></i><b>3.3.1</b> Business logic &amp; application logic</a></li>
<li class="chapter" data-level="3.3.2" data-path="structure.html"><a href="structure.html#small-is-beautiful-bis-repetita"><i class="fa fa-check"></i><b>3.3.2</b> Small is beautiful (bis repetita)</a></li>
<li class="chapter" data-level="3.3.3" data-path="structure.html"><a href="structure.html#conventions-matter"><i class="fa fa-check"></i><b>3.3.3</b> Conventions matter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="golem.html"><a href="golem.html"><i class="fa fa-check"></i><b>4</b> Introduction to <code>{golem}</code></a><ul>
<li class="chapter" data-level="4.1" data-path="golem.html"><a href="golem.html#what-is-golem"><i class="fa fa-check"></i><b>4.1</b> What is <code>{golem}</code>?</a></li>
<li class="chapter" data-level="4.2" data-path="golem.html"><a href="golem.html#understanding-golem-app-structure"><i class="fa fa-check"></i><b>4.2</b> Understanding <code>{golem}</code> app structure</a><ul>
<li class="chapter" data-level="4.2.1" data-path="golem.html"><a href="golem.html#description-namespace"><i class="fa fa-check"></i><b>4.2.1</b> <code>DESCRIPTION</code> &amp; <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="golem.html"><a href="golem.html#r"><i class="fa fa-check"></i><b>4.2.2</b> R/</a></li>
<li class="chapter" data-level="4.2.3" data-path="golem.html"><a href="golem.html#instappwww"><i class="fa fa-check"></i><b>4.2.3</b> <code>inst/app/www/</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="golem.html"><a href="golem.html#dev"><i class="fa fa-check"></i><b>4.2.4</b> <code>dev/</code></a></li>
<li class="chapter" data-level="4.2.5" data-path="golem.html"><a href="golem.html#man"><i class="fa fa-check"></i><b>4.2.5</b> <code>man/</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>5</b> The workflow</a><ul>
<li class="chapter" data-level="5.1" data-path="workflow.html"><a href="workflow.html#part-1-design"><i class="fa fa-check"></i><b>5.1</b> Part 1: Design</a></li>
<li class="chapter" data-level="5.2" data-path="workflow.html"><a href="workflow.html#part-2-prototype"><i class="fa fa-check"></i><b>5.2</b> Part 2: Prototype</a></li>
<li class="chapter" data-level="5.3" data-path="workflow.html"><a href="workflow.html#part-3-build"><i class="fa fa-check"></i><b>5.3</b> Part 3: Build</a></li>
<li class="chapter" data-level="5.4" data-path="workflow.html"><a href="workflow.html#part-4-secure"><i class="fa fa-check"></i><b>5.4</b> Part 4: Secure</a></li>
<li class="chapter" data-level="5.5" data-path="workflow.html"><a href="workflow.html#part-5-deploy"><i class="fa fa-check"></i><b>5.5</b> Part 5: Deploy</a></li>
</ul></li>
<li class="part"><span><b>II Step 1: Design</b></span></li>
<li class="chapter" data-level="6" data-path="matters.html"><a href="matters.html"><i class="fa fa-check"></i><b>6</b> UX Matters</a><ul>
<li class="chapter" data-level="6.1" data-path="matters.html"><a href="matters.html#simplicity-is-gold"><i class="fa fa-check"></i><b>6.1</b> Simplicity is Gold</a><ul>
<li class="chapter" data-level="6.1.1" data-path="matters.html"><a href="matters.html#how-we-read-the-web-scanning-content"><i class="fa fa-check"></i><b>6.1.1</b> How we read the web: scanning content</a></li>
<li class="chapter" data-level="6.1.2" data-path="matters.html"><a href="matters.html#a-self-evident-app-or-at-least-self-explanatory"><i class="fa fa-check"></i><b>6.1.2</b> A self-evident app (or at least self-explanatory)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="matters.html"><a href="matters.html#the-danger-of-feature-creep"><i class="fa fa-check"></i><b>6.2</b> The danger of feature-creep</a><ul>
<li class="chapter" data-level="6.2.1" data-path="matters.html"><a href="matters.html#whats-feature-creep"><i class="fa fa-check"></i><b>6.2.1</b> What’s feature-creep?</a></li>
<li class="chapter" data-level="6.2.2" data-path="matters.html"><a href="matters.html#restrain-reactivity"><i class="fa fa-check"></i><b>6.2.2</b> Restrain reactivity</a></li>
<li class="chapter" data-level="6.2.3" data-path="matters.html"><a href="matters.html#too-much-interactivity"><i class="fa fa-check"></i><b>6.2.3</b> Too much interactivity</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="matters.html"><a href="matters.html#web-accessibility"><i class="fa fa-check"></i><b>6.3</b> Web Accessibility</a><ul>
<li class="chapter" data-level="6.3.1" data-path="matters.html"><a href="matters.html#about-accessibility"><i class="fa fa-check"></i><b>6.3.1</b> About Accessibility</a></li>
<li class="chapter" data-level="6.3.2" data-path="matters.html"><a href="matters.html#making-your-app-accessible"><i class="fa fa-check"></i><b>6.3.2</b> Making your App Accessible</a></li>
<li class="chapter" data-level="6.3.3" data-path="matters.html"><a href="matters.html#evaluating-your-app-accessibility-further-reading"><i class="fa fa-check"></i><b>6.3.3</b> Evaluating your App Accessibility &amp; Further reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="step-design.html"><a href="step-design.html"><i class="fa fa-check"></i><b>7</b> Don’t rush into coding</a><ul>
<li class="chapter" data-level="7.1" data-path="step-design.html"><a href="step-design.html#designing-before-coding"><i class="fa fa-check"></i><b>7.1</b> Designing before coding</a><ul>
<li class="chapter" data-level="7.1.1" data-path="step-design.html"><a href="step-design.html#the-urge-to-code"><i class="fa fa-check"></i><b>7.1.1</b> The Urge to Code</a></li>
<li class="chapter" data-level="7.1.2" data-path="step-design.html"><a href="step-design.html#about-concept-map"><i class="fa fa-check"></i><b>7.1.2</b> About Concept Map</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="step-design.html"><a href="step-design.html#ask-questions"><i class="fa fa-check"></i><b>7.2</b> Ask questions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="step-design.html"><a href="step-design.html#about-the-end-users"><i class="fa fa-check"></i><b>7.2.1</b> About the end users</a></li>
<li class="chapter" data-level="7.2.2" data-path="step-design.html"><a href="step-design.html#pre-existing-code-base"><i class="fa fa-check"></i><b>7.2.2</b> Pre-existing code-base</a></li>
<li class="chapter" data-level="7.2.3" data-path="step-design.html"><a href="step-design.html#deployment"><i class="fa fa-check"></i><b>7.2.3</b> Deployment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>8</b> A Gentle Introduction to CSS</a><ul>
<li class="chapter" data-level="8.1" data-path="css.html"><a href="css.html#what-is-css"><i class="fa fa-check"></i><b>8.1</b> What is CSS</a><ul>
<li class="chapter" data-level="8.1.1" data-path="css.html"><a href="css.html#about-css"><i class="fa fa-check"></i><b>8.1.1</b> About CSS</a></li>
<li class="chapter" data-level="8.1.2" data-path="css.html"><a href="css.html#shinys-default-fluidpage"><i class="fa fa-check"></i><b>8.1.2</b> Shiny’s default: <code>fluidPage()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="css.html"><a href="css.html#getting-started-with-css"><i class="fa fa-check"></i><b>8.2</b> Getting started with CSS</a><ul>
<li class="chapter" data-level="8.2.1" data-path="css.html"><a href="css.html#about-css-syntax"><i class="fa fa-check"></i><b>8.2.1</b> About CSS syntax</a></li>
<li class="chapter" data-level="8.2.2" data-path="css.html"><a href="css.html#css-selectors"><i class="fa fa-check"></i><b>8.2.2</b> CSS selectors</a></li>
<li class="chapter" data-level="8.2.3" data-path="css.html"><a href="css.html#css-properties"><i class="fa fa-check"></i><b>8.2.3</b> CSS properties</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="css.html"><a href="css.html#integrate-css-files-to-your-shiny-app"><i class="fa fa-check"></i><b>8.3</b> Integrate CSS files to your Shiny App</a><ul>
<li class="chapter" data-level="8.3.1" data-path="css.html"><a href="css.html#inline-css"><i class="fa fa-check"></i><b>8.3.1</b> Inline CSS</a></li>
<li class="chapter" data-level="8.3.2" data-path="css.html"><a href="css.html#writing-in-a-tagsstyle"><i class="fa fa-check"></i><b>8.3.2</b> Writing in a <code>tags$style()</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="css.html"><a href="css.html#including-external-files"><i class="fa fa-check"></i><b>8.3.3</b> Including External Files</a></li>
<li class="chapter" data-level="8.3.4" data-path="css.html"><a href="css.html#using-r-packages"><i class="fa fa-check"></i><b>8.3.4</b> Using R packages</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="css.html"><a href="css.html#external-resources"><i class="fa fa-check"></i><b>8.4</b> External resources</a></li>
</ul></li>
<li class="part"><span><b>III Step 2: Prototype</b></span></li>
<li class="chapter" data-level="9" data-path="stepprotopype.html"><a href="stepprotopype.html"><i class="fa fa-check"></i><b>9</b> Building an “ipsum-app”</a><ul>
<li class="chapter" data-level="9.1" data-path="stepprotopype.html"><a href="stepprotopype.html#prototyping-is-crucial"><i class="fa fa-check"></i><b>9.1</b> Prototyping is crucial</a><ul>
<li class="chapter" data-level="9.1.1" data-path="stepprotopype.html"><a href="stepprotopype.html#the-ui-first-approach"><i class="fa fa-check"></i><b>9.1.1</b> The “UI first” approach</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="stepprotopype.html"><a href="stepprotopype.html#prototyping-shiny"><i class="fa fa-check"></i><b>9.2</b> Prototyping Shiny</a><ul>
<li class="chapter" data-level="9.2.1" data-path="stepprotopype.html"><a href="stepprotopype.html#fast-prototyping-with-shinipsum"><i class="fa fa-check"></i><b>9.2.1</b> Fast prototyping with <code>{shinipsum}</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="stepprotopype.html"><a href="stepprotopype.html#using-fakir-for-fake-data-generation"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>{fakir}</code> for fake data generation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html"><i class="fa fa-check"></i><b>10</b> Building with RMarkdown</a><ul>
<li class="chapter" data-level="10.1" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html#define-the-content-of-the-application"><i class="fa fa-check"></i><b>10.1</b> Define the content of the application</a></li>
<li class="chapter" data-level="10.2" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html#fill-the-rmd-files"><i class="fa fa-check"></i><b>10.2</b> Fill the Rmd files</a></li>
<li class="chapter" data-level="10.3" data-path="proto-rmdfirst.html"><a href="proto-rmdfirst.html#use-the-rmd-first-method-to-document-further"><i class="fa fa-check"></i><b>10.3</b> Use the ‘Rmd first’ method to document further</a></li>
</ul></li>
<li class="part"><span><b>IV Step 3: Build</b></span></li>
<li class="chapter" data-level="11" data-path="stepbuild.html"><a href="stepbuild.html"><i class="fa fa-check"></i><b>11</b> Building app with <code>{golem}</code></a><ul>
<li class="chapter" data-level="11.1" data-path="stepbuild.html"><a href="stepbuild.html#using-golem"><i class="fa fa-check"></i><b>11.1</b> Using <code>{golem}</code></a><ul>
<li class="chapter" data-level="11.1.1" data-path="stepbuild.html"><a href="stepbuild.html#create-a-package"><i class="fa fa-check"></i><b>11.1.1</b> Create a package</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="stepbuild.html"><a href="stepbuild.html#dev01_start.r"><i class="fa fa-check"></i><b>11.2</b> <code>dev/01_start.R</code></a><ul>
<li class="chapter" data-level="11.2.1" data-path="stepbuild.html"><a href="stepbuild.html#fill-the-desc"><i class="fa fa-check"></i><b>11.2.1</b> Fill the DESC</a></li>
<li class="chapter" data-level="11.2.2" data-path="stepbuild.html"><a href="stepbuild.html#set-common-files"><i class="fa fa-check"></i><b>11.2.2</b> Set common Files</a></li>
<li class="chapter" data-level="11.2.3" data-path="stepbuild.html"><a href="stepbuild.html#add-a-data-raw-folder"><i class="fa fa-check"></i><b>11.2.3</b> Add a data-raw folder</a></li>
<li class="chapter" data-level="11.2.4" data-path="stepbuild.html"><a href="stepbuild.html#init-tests"><i class="fa fa-check"></i><b>11.2.4</b> Init Tests</a></li>
<li class="chapter" data-level="11.2.5" data-path="stepbuild.html"><a href="stepbuild.html#use-recommended-package"><i class="fa fa-check"></i><b>11.2.5</b> Use Recommended Package</a></li>
<li class="chapter" data-level="11.2.6" data-path="stepbuild.html"><a href="stepbuild.html#add-various-tools"><i class="fa fa-check"></i><b>11.2.6</b> Add various tools</a></li>
<li class="chapter" data-level="11.2.7" data-path="stepbuild.html"><a href="stepbuild.html#if-you-want-to-change-the-default-favicon"><i class="fa fa-check"></i><b>11.2.7</b> If you want to change the default favicon</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="stepbuild.html"><a href="stepbuild.html#day-to-day-dev-with-golem"><i class="fa fa-check"></i><b>11.3</b> Day to Day Dev with <code>{golem}</code></a></li>
<li class="chapter" data-level="11.4" data-path="stepbuild.html"><a href="stepbuild.html#launching-the-app"><i class="fa fa-check"></i><b>11.4</b> Launching the app</a></li>
<li class="chapter" data-level="11.5" data-path="stepbuild.html"><a href="stepbuild.html#dev02_dev.r"><i class="fa fa-check"></i><b>11.5</b> <code>dev/02_dev.R</code></a><ul>
<li class="chapter" data-level="11.5.1" data-path="stepbuild.html"><a href="stepbuild.html#add-modules"><i class="fa fa-check"></i><b>11.5.1</b> Add modules</a></li>
<li class="chapter" data-level="11.5.2" data-path="stepbuild.html"><a href="stepbuild.html#add-dependencies"><i class="fa fa-check"></i><b>11.5.2</b> Add dependencies</a></li>
<li class="chapter" data-level="11.5.3" data-path="stepbuild.html"><a href="stepbuild.html#add-tests"><i class="fa fa-check"></i><b>11.5.3</b> Add tests</a></li>
<li class="chapter" data-level="11.5.4" data-path="stepbuild.html"><a href="stepbuild.html#add-a-browser-button"><i class="fa fa-check"></i><b>11.5.4</b> Add a browser button</a></li>
<li class="chapter" data-level="11.5.5" data-path="stepbuild.html"><a href="stepbuild.html#add-external-files"><i class="fa fa-check"></i><b>11.5.5</b> Add external files</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="stepbuild.html"><a href="stepbuild.html#adding-these-external-resources-to-your-app"><i class="fa fa-check"></i><b>11.6</b> Adding these external resources to your app</a></li>
<li class="chapter" data-level="11.7" data-path="stepbuild.html"><a href="stepbuild.html#documentation"><i class="fa fa-check"></i><b>11.7</b> Documentation</a><ul>
<li class="chapter" data-level="11.7.1" data-path="stepbuild.html"><a href="stepbuild.html#vignette"><i class="fa fa-check"></i><b>11.7.1</b> Vignette</a></li>
<li class="chapter" data-level="11.7.2" data-path="stepbuild.html"><a href="stepbuild.html#code-coverage"><i class="fa fa-check"></i><b>11.7.2</b> Code coverage</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="stepbuild.html"><a href="stepbuild.html#using-golem-dev-functions"><i class="fa fa-check"></i><b>11.8</b> Using <code>{golem}</code> dev functions</a></li>
</ul></li>
<li class="part"><span><b>V Step 4: Strengthen</b></span></li>
<li class="chapter" data-level="12" data-path="step-secure.html"><a href="step-secure.html"><i class="fa fa-check"></i><b>12</b> Build yourself a safety net</a><ul>
<li class="chapter" data-level="12.1" data-path="step-secure.html"><a href="step-secure.html#testing-your-app"><i class="fa fa-check"></i><b>12.1</b> Testing your app</a><ul>
<li class="chapter" data-level="12.1.1" data-path="step-secure.html"><a href="step-secure.html#testing-the-business-logic"><i class="fa fa-check"></i><b>12.1.1</b> Testing the business logic</a></li>
<li class="chapter" data-level="12.1.2" data-path="step-secure.html"><a href="step-secure.html#testing-the-interactive-logic"><i class="fa fa-check"></i><b>12.1.2</b> Testing the interactive logic</a></li>
<li class="chapter" data-level="12.1.3" data-path="step-secure.html"><a href="step-secure.html#testing-the-app-load"><i class="fa fa-check"></i><b>12.1.3</b> Testing the app load</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="step-secure.html"><a href="step-secure.html#a-reproducible-environment"><i class="fa fa-check"></i><b>12.2</b> A reproducible environment</a><ul>
<li class="chapter" data-level="12.2.1" data-path="step-secure.html"><a href="step-secure.html#renv"><i class="fa fa-check"></i><b>12.2.1</b> {renv}</a></li>
<li class="chapter" data-level="12.2.2" data-path="step-secure.html"><a href="step-secure.html#docker-rstudio-connect"><i class="fa fa-check"></i><b>12.2.2</b> Docker &amp; RStudio Connect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="secure.html"><a href="secure.html"><i class="fa fa-check"></i><b>13</b> Version Control</a><ul>
<li class="chapter" data-level="13.1" data-path="secure.html"><a href="secure.html#using-version-control-with-git"><i class="fa fa-check"></i><b>13.1</b> Using Version Control with <code>git</code></a><ul>
<li class="chapter" data-level="13.1.1" data-path="secure.html"><a href="secure.html#why-version-control"><i class="fa fa-check"></i><b>13.1.1</b> Why Version Control?</a></li>
<li class="chapter" data-level="13.1.2" data-path="secure.html"><a href="secure.html#git-basics-commit---push---pull"><i class="fa fa-check"></i><b>13.1.2</b> <code>Git</code> basics: <code>commit</code> - <code>push</code> - <code>pull</code></a></li>
<li class="chapter" data-level="13.1.3" data-path="secure.html"><a href="secure.html#about-branches"><i class="fa fa-check"></i><b>13.1.3</b> About branches</a></li>
<li class="chapter" data-level="13.1.4" data-path="secure.html"><a href="secure.html#issues"><i class="fa fa-check"></i><b>13.1.4</b> Issues</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="secure.html"><a href="secure.html#git-integration"><i class="fa fa-check"></i><b>13.2</b> Git integration</a><ul>
<li class="chapter" data-level="13.2.1" data-path="secure.html"><a href="secure.html#with-rstudio"><i class="fa fa-check"></i><b>13.2.1</b> With RStudio</a></li>
<li class="chapter" data-level="13.2.2" data-path="secure.html"><a href="secure.html#as-part-of-a-larger-world"><i class="fa fa-check"></i><b>13.2.2</b> As part of a larger world</a></li>
<li class="chapter" data-level="13.2.3" data-path="secure.html"><a href="secure.html#about-git-flow"><i class="fa fa-check"></i><b>13.2.3</b> About <code>git-flow</code></a></li>
<li class="chapter" data-level="13.2.4" data-path="secure.html"><a href="secure.html#further-readings-on-git"><i class="fa fa-check"></i><b>13.2.4</b> Further readings on <code>git</code></a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="secure.html"><a href="secure.html#ci-and-testing"><i class="fa fa-check"></i><b>13.3</b> CI and testing</a></li>
</ul></li>
<li class="part"><span><b>VI Step 5: Deploy</b></span></li>
<li class="chapter" data-level="14" data-path="stepdeploy.html"><a href="stepdeploy.html"><i class="fa fa-check"></i><b>14</b> Send your app to production</a><ul>
<li class="chapter" data-level="14.1" data-path="stepdeploy.html"><a href="stepdeploy.html#where-to-deploy-your-app"><i class="fa fa-check"></i><b>14.1</b> Where to deploy your app</a></li>
<li class="chapter" data-level="14.2" data-path="stepdeploy.html"><a href="stepdeploy.html#before-deployment-check-list"><i class="fa fa-check"></i><b>14.2</b> Before deployment Check-list</a><ul>
<li class="chapter" data-level="14.2.1" data-path="stepdeploy.html"><a href="stepdeploy.html#what-to-check-on-the-app"><i class="fa fa-check"></i><b>14.2.1</b> What to check on the app</a></li>
<li class="chapter" data-level="14.2.2" data-path="stepdeploy.html"><a href="stepdeploy.html#what-to-check-in-the-production-envionment"><i class="fa fa-check"></i><b>14.2.2</b> What to check in the production envionment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="deploy-golem.html"><a href="deploy-golem.html"><i class="fa fa-check"></i><b>15</b> Deploy with <code>{golem}</code></a><ul>
<li class="chapter" data-level="15.1" data-path="deploy-golem.html"><a href="deploy-golem.html#local-deployment-1"><i class="fa fa-check"></i><b>15.1</b> Local deployment</a></li>
<li class="chapter" data-level="15.2" data-path="deploy-golem.html"><a href="deploy-golem.html#deploying-apps-with-golem"><i class="fa fa-check"></i><b>15.2</b> Deploying Apps with <code>{golem}</code></a></li>
<li class="chapter" data-level="15.3" data-path="deploy-golem.html"><a href="deploy-golem.html#rstudio-environments"><i class="fa fa-check"></i><b>15.3</b> RStudio Environments</a></li>
<li class="chapter" data-level="15.4" data-path="deploy-golem.html"><a href="deploy-golem.html#docker"><i class="fa fa-check"></i><b>15.4</b> Docker</a></li>
</ul></li>
<li class="part"><span><b>VII Optimizing</b></span></li>
<li class="chapter" data-level="16" data-path="when-optimize.html"><a href="when-optimize.html"><i class="fa fa-check"></i><b>16</b> The Need for Optimization</a><ul>
<li class="chapter" data-level="16.1" data-path="when-optimize.html"><a href="when-optimize.html#build-first-then-optimize"><i class="fa fa-check"></i><b>16.1</b> Build first, then optimize</a><ul>
<li class="chapter" data-level="16.1.1" data-path="when-optimize.html"><a href="when-optimize.html#identifying-bottlenecks"><i class="fa fa-check"></i><b>16.1.1</b> Identifying bottlenecks</a></li>
<li class="chapter" data-level="16.1.2" data-path="when-optimize.html"><a href="when-optimize.html#do-you-need-faster-functions"><i class="fa fa-check"></i><b>16.1.2</b> Do you need faster functions?</a></li>
<li class="chapter" data-level="16.1.3" data-path="when-optimize.html"><a href="when-optimize.html#dont-sacrifice-readability"><i class="fa fa-check"></i><b>16.1.3</b> Don’t sacrifice readability</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="when-optimize.html"><a href="when-optimize.html#tools-for-profiling"><i class="fa fa-check"></i><b>16.2</b> Tools for profiling</a><ul>
<li class="chapter" data-level="16.2.1" data-path="when-optimize.html"><a href="when-optimize.html#profiling-r-code"><i class="fa fa-check"></i><b>16.2.1</b> Profiling R code</a></li>
<li class="chapter" data-level="16.2.2" data-path="when-optimize.html"><a href="when-optimize.html#profiling-shiny"><i class="fa fa-check"></i><b>16.2.2</b> Profiling Shiny</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="optim-caveat.html"><a href="optim-caveat.html"><i class="fa fa-check"></i><b>17</b> Common Application Caveats</a><ul>
<li class="chapter" data-level="17.1" data-path="optim-caveat.html"><a href="optim-caveat.html#reactivity-anti-patterns"><i class="fa fa-check"></i><b>17.1</b> Reactivity anti-patterns</a><ul>
<li class="chapter" data-level="17.1.1" data-path="optim-caveat.html"><a href="optim-caveat.html#reactivity-is-awesome-until-its-not"><i class="fa fa-check"></i><b>17.1.1</b> Reactivity is awesome… until it’s not</a></li>
<li class="chapter" data-level="17.1.2" data-path="optim-caveat.html"><a href="optim-caveat.html#observe-vs-observeevent"><i class="fa fa-check"></i><b>17.1.2</b> <code>observe</code> vs <code>observeEvent</code></a></li>
<li class="chapter" data-level="17.1.3" data-path="optim-caveat.html"><a href="optim-caveat.html#building-triggers-and-watchers"><i class="fa fa-check"></i><b>17.1.3</b> Building triggers and watchers</a></li>
<li class="chapter" data-level="17.1.4" data-path="optim-caveat.html"><a href="optim-caveat.html#using-r6-as-a-data-storage"><i class="fa fa-check"></i><b>17.1.4</b> Using R6 as a data storage</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="optim-caveat.html"><a href="optim-caveat.html#r-does-too-much"><i class="fa fa-check"></i><b>17.2</b> R does too much</a></li>
<li class="chapter" data-level="17.3" data-path="optim-caveat.html"><a href="optim-caveat.html#reading-data"><i class="fa fa-check"></i><b>17.3</b> Reading data</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html"><i class="fa fa-check"></i><b>18</b> Optimizing Shiny Code</a><ul>
<li class="chapter" data-level="18.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#optimizing-r-code"><i class="fa fa-check"></i><b>18.1</b> Optimizing R code</a></li>
<li class="chapter" data-level="18.2" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#caching-elements"><i class="fa fa-check"></i><b>18.2</b> Caching elements</a><ul>
<li class="chapter" data-level="18.2.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#whats-caching"><i class="fa fa-check"></i><b>18.2.1</b> What’s caching?</a></li>
<li class="chapter" data-level="18.2.2" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#using-caching-in-r"><i class="fa fa-check"></i><b>18.2.2</b> Using caching in R</a></li>
<li class="chapter" data-level="18.2.3" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#caching-shiny"><i class="fa fa-check"></i><b>18.2.3</b> Caching Shiny</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#asynchronous-in-shiny"><i class="fa fa-check"></i><b>18.3</b> Asynchronous in Shiny</a><ul>
<li class="chapter" data-level="18.3.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#how-to"><i class="fa fa-check"></i><b>18.3.1</b> How to</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="optimjs.html"><a href="optimjs.html"><i class="fa fa-check"></i><b>19</b> Using JavaScript</a><ul>
<li class="chapter" data-level="19.1" data-path="optimjs.html"><a href="optimjs.html#a-quick-introduction-to-javascript"><i class="fa fa-check"></i><b>19.1</b> A quick introduction to JavaScript</a><ul>
<li class="chapter" data-level="19.1.1" data-path="optimjs.html"><a href="optimjs.html#understanding-html-class-and-id"><i class="fa fa-check"></i><b>19.1.1</b> Understanding html, class, and id</a></li>
<li class="chapter" data-level="19.1.2" data-path="optimjs.html"><a href="optimjs.html#about-jquery-jquery-selectors"><i class="fa fa-check"></i><b>19.1.2</b> About jQuery &amp; jQuery selectors</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="optimjs.html"><a href="optimjs.html#client-side-javascript"><i class="fa fa-check"></i><b>19.2</b> Client-side JavaScript</a><ul>
<li class="chapter" data-level="19.2.1" data-path="optimjs.html"><a href="optimjs.html#common-patterns"><i class="fa fa-check"></i><b>19.2.1</b> Common patterns</a></li>
<li class="chapter" data-level="19.2.2" data-path="optimjs.html"><a href="optimjs.html#where-to-put-them---introduction-to-javascript-events"><i class="fa fa-check"></i><b>19.2.2</b> Where to put them - introduction to JavaScript events</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="optimjs.html"><a href="optimjs.html#javascript---shiny-communication"><i class="fa fa-check"></i><b>19.3</b> JavaScript &lt;-&gt; Shiny communication</a><ul>
<li class="chapter" data-level="19.3.1" data-path="optimjs.html"><a href="optimjs.html#from-r-to-javascript"><i class="fa fa-check"></i><b>19.3.1</b> From R to JavaScript</a></li>
<li class="chapter" data-level="19.3.2" data-path="optimjs.html"><a href="optimjs.html#from-javascript-to-r"><i class="fa fa-check"></i><b>19.3.2</b> From JavaScript to R</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="optimjs.html"><a href="optimjs.html#about-golem-js-functions"><i class="fa fa-check"></i><b>19.4</b> About <code>{golem}</code> js functions</a><ul>
<li class="chapter" data-level="19.4.1" data-path="optimjs.html"><a href="optimjs.html#goleminvoke_js"><i class="fa fa-check"></i><b>19.4.1</b> <code>golem::invoke_js()</code></a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="optimjs.html"><a href="optimjs.html#learn-more-about-javascript"><i class="fa fa-check"></i><b>19.5</b> Learn more about JavaScript</a><ul>
<li class="chapter" data-level="19.5.1" data-path="optimjs.html"><a href="optimjs.html#javascript-basics"><i class="fa fa-check"></i><b>19.5.1</b> JavaScript basics</a></li>
<li class="chapter" data-level="19.5.2" data-path="optimjs.html"><a href="optimjs.html#jquery"><i class="fa fa-check"></i><b>19.5.2</b> jQuery</a></li>
<li class="chapter" data-level="19.5.3" data-path="optimjs.html"><a href="optimjs.html#intermediate-advanced-javascript"><i class="fa fa-check"></i><b>19.5.3</b> Intermediate / advanced JavaScript</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://rtask.thinkr.fr">A book by the ThinkR team</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Engineering Production-Grade Shiny Apps</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="structure" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Structuring your Project</h1>
<div id="shiny-app-as-a-package" class="section level2">
<h2><span class="header-section-number">3.1</span> Shiny App as a Package</h2>
<p>A robust, maintenable and shareable Shiny application finds its way through a R package structure.</p>
<p>In the next chapter you will be introduced to the <code>{golem}</code> package, which is <strong>an opinionated framework for building production-ready Shiny Applications</strong>.
This framework starts by creating a package skeleton waiting to be filled.</p>
<p>But, in a world where Shiny Applications are mostly created as a series of files, why bother with a package?</p>
<div id="what-is-your-organisation-for-a-shiny-app-project" class="section level3">
<h3><span class="header-section-number">3.1.1</span> What is your organisation for a Shiny App project?</h3>
<p>You may not realise yet, but solutions you give to the questions and problems you have when you want to put your app in production are in the direction of building a package.</p>
<p>Indeed, let us see that the other way round.
Think about your last Shiny app, which was created as a single-file (<code>app.R</code>) or two files app (<code>ui.R</code> and <code>server.R</code>).
You put them in a folder.</p>
<p>Now, let’s review <strong>what you will need next for a robust application</strong>.</p>
<p>First, <strong>metadata.</strong>
In other words, the name of the app, the version number (which is crucial to any serious, production-level project), what the application does, who to contact if something goes wrong.</p>
<p>Second, you need to find a way to <strong>handle the dependencies</strong>.
Because you know, when you want to push your app into production, you can not have this conversation with I.T. people:</p>
<blockquote>
<p>IT: Hey, I tried to <code>source(&quot;app.R&quot;)</code> but I got an error.</p>
<p>R-dev: What is the error?</p>
<p>IT: It says “could not find package ‘shiny’”.</p>
<p>R-dev: Ah yes, you need to install {shiny}. Try to run <code>install.packages(&quot;shiny&quot;)</code>.</p>
<p>IT: OK nice. What else?</p>
<p>R-dev: Let me think, try also <code>install.packages(&quot;DT&quot;)</code>… good? Now try <code>install.packages(&quot;ggplot2&quot;)</code>, and …</p>
<p>[…]</p>
<p>IT: Ok, now I source the ‘app.R’, right?</p>
<p>R-dev: Sure!</p>
<p>IT: Ok so it says ‘could not find function <code>runApp()</code>’</p>
<p>R-dev: Ah, you got to do <code>library(shiny)</code> at the beginning of your script. And <code>library(purrr)</code>, and <code>library(jsonlite)</code>*.</p>
</blockquote>
<p><code>*</code> Which will lead to a Namespace conflict on the <code>flatten()</code> function that can cause you some debugging headache.
So, hey, it would be cool if we could have a Shiny app that only imports specific functions from a package, right?</p>
<p><strong>So yes, dependencies matter. You need to handle them, and handle them correctly.</strong></p>
<p>Third, let us say you are building a big app.
Something with thousands of lines of code.
Handling a one-file or two-file shiny app with that much lines is just a nightmare.
So, what to do?
Let us split everything into smaller files that we can call!
Maybe, we can store these files in a specific directory.
We can name this directory, “R” for instance.</p>
<p>Last but not least, we want our app to live long and prosper, which means we need to document it: <strong>each small piece of code should have a piece of comment</strong> to explain what these specific lines do.
The other thing we need for our application to be successful on the long term is tests, so that we are sure we are not introducing any regression along development.</p>
<p>Oh, and that would be nice if people could get a <code>tar.gz</code> and install it on their computer and have access to a local copy of the app!</p>
<p>OK, so let’s sum it up: we want to build an app.
This app needs to have <strong>metadata</strong> and to handle <strong>dependencies</strong> correctly, which is what you get from the <code>DESCRIPTION</code> + <code>NAMESPACE</code> files of a package.
Even more practical is the fact that you can do “selective namespace extraction” inside a package, <em>i.e.</em> you can say “I want this function from this package”.
Also, <strong>this app needs to be split up in smaller <code>.R</code> files</strong>, stored in a specific directory, which is the way a package is organized.
And I do not need to emphasize how <strong>documentation</strong> is a vital part of any package, so we solved this question too here. So is the <strong>testing toolkit</strong>.
And of course, the “install everywhere” wish comes to life when a Shiny App is in a package.</p>
</div>
<div id="document-and-test" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Document and test</h3>
<p>As for any software in production, assuring the usability and sustainability of your app will be through documentation and preventive testing.</p>
<div id="documenting-your-app" class="section level4">
<h4><span class="header-section-number">3.1.2.1</span> Documenting your app</h4>
<p>Documentation of your Shiny application is the documentation of features explained to future developers (likely you in the future) and documentation for the users.
Documenting packages is a mandatory step for any R developer.
As for any package, there are different places for documentation :</p>
<ul>
<li>A ‘README’ file at the root of your package, which will document installation and the general use, easily rendered in your graphical interface for git.<br />
</li>
<li>‘Vignettes’ that explain how to use your app.
There are also used to detail the core functions of the application as a static document, ideally one vignette per shiny page / tab.
Use them as the laboratory for setting up your Shiny features with reproducible examples, but also as the place to build your user guide.<br />
</li>
<li>Functions documentation.
Any exported function should have its own documentation, hence you are “forced” to document any user facing-function.
Use the vignette reproducible examples to document the use of functions and their parameters.</li>
<li>A {pkgdown} that can be used as an external link to share the documentation of your application, <em>i.e.</em> installation steps for I.T., internal features use for developers and` user guide.</li>
</ul>
</div>
<div id="testing" class="section level4">
<h4><span class="header-section-number">3.1.2.2</span> Testing</h4>
<p>Testing production apps is a wide question, here, we will just stick to unit tests inside a package, with the help of {golem} for Shiny specific structures.</p>
<p><strong>Nothing should go to production without being tested. Nothing.</strong>
Frameworks for R package testing are robust and widely documented.
So you do not have to put any extra-effort here: use a canonical testing framework like <a href="https://testthat.r-lib.org/"><code>{testthat}</code></a>.
Learning how to use it is not the subject of this chapter, so feel free to refer to the documentation.
See also Chapter 5 of the <a href="https://speakerdeck.com/colinfay/building-a-package-that-lasts-erum-2018-workshop?slide=107">workshop: “Building a package that lasts”</a>.</p>
<p>What should you test?</p>
<ul>
<li><p>First of all, as we’ve said before, the app should be split between the UI part and the back-end (or ‘business logic’) part.
These back-end functions are supposed to run without any interactive context, just as plain old functions.
So for these ones, <strong>you can do classical tests</strong>.
As they are back-end functions (so specific to a project), <code>{golem}</code> will not provide any helpers for that.</p></li>
<li><p>For the UI part, <strong>remember that any UI function is designed to render an HTML element</strong>.
You can save a file as HTML and compare it to a UI object with the <code>golem::expect_html_equal()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">ui &lt;-<span class="st"> </span><span class="kw">tagList</span>(<span class="kw">h1</span>(<span class="st">&quot;Hello world!&quot;</span>))</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">htmltools<span class="op">::</span><span class="kw">save_html</span>(ui, <span class="st">&quot;ui.html&quot;</span>)</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">golem<span class="op">::</span><span class="kw">expect_html_equal</span>(ui, <span class="st">&quot;ui.html&quot;</span>) <span class="co"># OK</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5"><span class="co"># Changes </span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6">ui &lt;-<span class="st"> </span><span class="kw">tagList</span>(<span class="kw">h2</span>(<span class="st">&quot;Hello world!&quot;</span>))</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">golem<span class="op">::</span><span class="kw">expect_html_equal</span>(ui, <span class="st">&quot;ui.html&quot;</span>) <span class="co"># Error</span></a></code></pre></div>
<p>This can for example be useful if you need to test a module.
A UI module function returns a HTML tag list, so, once your modules are set, you can save them as HTML file and use them inside tests.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">my_mod_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(<span class="st">&quot;id&quot;</span>)</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb33-4" data-line-number="4">    <span class="kw">selectInput</span>(<span class="kw">ns</span>(<span class="st">&quot;this&quot;</span>), <span class="st">&quot;that&quot;</span>, <span class="dt">choices =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb33-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb33-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb33-7" data-line-number="7">my_mod_ui_test &lt;-<span class="st"> </span><span class="kw">tempfile</span>(<span class="dt">fileext =</span> <span class="st">&quot;html&quot;</span>)</a>
<a class="sourceLine" id="cb33-8" data-line-number="8">htmltools<span class="op">::</span><span class="kw">save_html</span>(<span class="kw">my_mod_ui</span>(<span class="st">&quot;test&quot;</span>), my_mod_ui_test)</a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="co"># Some time later, and of course saved in the test folder, </span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="co"># not as a temp file</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11">golem<span class="op">::</span><span class="kw">expect_html_equal</span>(<span class="kw">my_mod_ui</span>(<span class="st">&quot;test&quot;</span>), my_mod_ui_test) <span class="co"># OK</span></a></code></pre></div>
<p><code>{golem}</code> also provides two functions, <code>expect_shinytag()</code> and <code>expect_shinytaglist()</code>, which test if an object is of class <code>&quot;shiny.tag&quot;</code> or <code>&quot;shiny.tag.list&quot;</code>.</p>
<ul>
<li>Testing package launch: when launching <code>golem::use_recommended_tests()</code>, you will find a test built on top of <code>{processx}</code> that allows to check if the application is launch-able. Here is a short description of what happens:</li>
</ul>
<!-- COMMENT : -->
<!-- ça fait une dépendance de plus, mais un here::here() ce serait plus propre que setwd(), non ? -->
<!-- ça marche ce setwd("../../") sur tous les Windows ? -->
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># Standard testthat things</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw">context</span>(<span class="st">&quot;launch&quot;</span>)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="kw">library</span>(processx)</a>
<a class="sourceLine" id="cb34-5" data-line-number="5"></a>
<a class="sourceLine" id="cb34-6" data-line-number="6">testthat<span class="op">::</span><span class="kw">test_that</span>(</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">  <span class="st">&quot;app launches&quot;</span>,{</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">    <span class="co"># We are creating a new process that runs the app</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9">    x &lt;-<span class="st"> </span>process<span class="op">$</span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb34-10" data-line-number="10">      <span class="st">&quot;R&quot;</span>, </a>
<a class="sourceLine" id="cb34-11" data-line-number="11">      <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb34-12" data-line-number="12">        <span class="st">&quot;-e&quot;</span>, </a>
<a class="sourceLine" id="cb34-13" data-line-number="13">        <span class="co"># As we are in the tests/testthat dir, we are moving </span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14">        <span class="co"># to the root of the package before launching the whole package</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15">        <span class="co"># and we try to launch the app</span></a>
<a class="sourceLine" id="cb34-16" data-line-number="16">        <span class="st">&quot;here::here(); pkgload::load_all(); run_app()&quot;</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17">      )</a>
<a class="sourceLine" id="cb34-18" data-line-number="18">    )</a>
<a class="sourceLine" id="cb34-19" data-line-number="19">    <span class="co"># We leave some time for the app to launch</span></a>
<a class="sourceLine" id="cb34-20" data-line-number="20">    <span class="co"># Configure this according to your need</span></a>
<a class="sourceLine" id="cb34-21" data-line-number="21">    <span class="kw">Sys.sleep</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb34-22" data-line-number="22">    <span class="co"># We check that the app is alive</span></a>
<a class="sourceLine" id="cb34-23" data-line-number="23">    <span class="kw">expect_true</span>(x<span class="op">$</span><span class="kw">is_alive</span>())</a>
<a class="sourceLine" id="cb34-24" data-line-number="24">    <span class="co"># We kill it</span></a>
<a class="sourceLine" id="cb34-25" data-line-number="25">    x<span class="op">$</span><span class="kw">kill</span>()</a>
<a class="sourceLine" id="cb34-26" data-line-number="26">  }</a>
<a class="sourceLine" id="cb34-27" data-line-number="27">)</a></code></pre></div>
<p><em>Note</em>: this specific configuration will possibly fail on continuous integration platform as Gitlab CI or Travis.
A workaround is to, inside your CI .yml file, first install the package with <code>remotes::install_local()</code>, and then replace the <code>setwd (...) run_app()</code> command with <code>myuberapp::run_app()</code> (if your package is named {myuberapp}).</p>
<p>For example:</p>
<ul>
<li>in <code>.gitlab-ci.yml</code>:</li>
</ul>
<pre><code>test:
stage: test
script: 
- echo &quot;Running tests&quot;
- R -e &#39;remotes::install_local()&#39;
- R -e &#39;devtools::check()&#39;</code></pre>
<ul>
<li>in <code>test-golem.R</code>:</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">testthat<span class="op">::</span><span class="kw">test_that</span>(</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">  <span class="st">&quot;app launches&quot;</span>,{</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">    x &lt;-<span class="st"> </span>process<span class="op">$</span><span class="kw">new</span>( </a>
<a class="sourceLine" id="cb36-4" data-line-number="4">      <span class="st">&quot;R&quot;</span>, </a>
<a class="sourceLine" id="cb36-5" data-line-number="5">      <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">        <span class="st">&quot;-e&quot;</span>, </a>
<a class="sourceLine" id="cb36-7" data-line-number="7">        <span class="st">&quot;myuberapp::run_app()&quot;</span></a>
<a class="sourceLine" id="cb36-8" data-line-number="8">      )</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">    )</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">    <span class="kw">Sys.sleep</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">    <span class="kw">expect_true</span>(x<span class="op">$</span><span class="kw">is_alive</span>())</a>
<a class="sourceLine" id="cb36-12" data-line-number="12">    x<span class="op">$</span><span class="kw">kill</span>()</a>
<a class="sourceLine" id="cb36-13" data-line-number="13">  }</a>
<a class="sourceLine" id="cb36-14" data-line-number="14">)</a></code></pre></div>
</div>
</div>
<div id="deploy" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Deploy</h3>
<p>Putting your application in production means that it should be deployed on a computer or a server somewhere to be used by other people than the developers.</p>
<div id="local-deployment" class="section level4">
<h4><span class="header-section-number">3.1.3.1</span> Local deployment</h4>
<p>With a package, you can use classical tools to locally install your Shiny application.
Inded, a Shiny App as a standard R package can be built as a <code>tar.gz</code>, sent to your colleagues, friends, and family, and even to the CRAN.
It can also be installed in any R-package repository.
You can then install your packaged App along with its dependencies using the appropriate <code>remotes::install_*()</code> command.
And, if you built your app with <code>{golem}</code>, you will launch the app using:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">library</span>(myuberapp)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">run_app</span>()</a></code></pre></div>
</div>
<div id="rstudio-connect-shiny-server" class="section level4">
<h4><span class="header-section-number">3.1.3.2</span> RStudio Connect &amp; Shiny Server</h4>
<p>Sending a Shiny application to a Rstudio product currently requires the correct R script at the root of your package directory.</p>
<p>These Rstudio platforms putting Shiny application into production expect a file app configuration, <em>i.e.</em> an <code>app.R</code> file or <code>ui.R</code> / <code>server.R</code> files.
To integrate your “Shiny App as a package” into Connect or Shiny Server, you can use two strategies:</p>
<ul>
<li>Use an internal package manager like <a href="https://www.rstudio.com/products/package-manager/">RStudio Package Manager</a>, where the package app is installed.
Once the package is available in your internal repository, you can create an <code>app.R</code> file with only this small piece of code:</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">library</span>(myuberapp)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="kw">run_app</span>()</a></code></pre></div>
<ul>
<li>Upload the complete content of the package directory to the server.
You will need an <code>app.R</code> file at the root of the package:</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># Load all R scripts and functions</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">pkgload<span class="op">::</span><span class="kw">load_all</span>()</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="co"># Launch the application</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4">shiny<span class="op">::</span><span class="kw">shinyApp</span>(<span class="dt">ui =</span> <span class="kw">app_ui</span>(), <span class="dt">server =</span> app_server) </a></code></pre></div>
<p>This is the file you will get if you run <code>golem::add_rconnect_file()</code>.</p>
<p>As you are in a package, you will have to hide the <code>app.R</code> file from package built by putting it in the <code>.Rbuildignore</code> file.</p>
</div>
<div id="docker-containers" class="section level4">
<h4><span class="header-section-number">3.1.3.3</span> Docker containers</h4>
<p>Docker containers can be used to embed a frozen OS that will launch your application in a safe environnement.
In order to dockerize your app, create a Dockerfile that list your package to be installed as in the local deployment with the appropriate <code>remotes::install_*()</code> function.
Then, use as a <code>CMD</code> <code>R -e 'options(&quot;shiny.port&quot; = 80, shiny.host = &quot;0.0.0.0&quot;); myuberapp::run_app()'</code> so that your app will be launched when starting the Docker container.
Change the output port to the one you need.</p>
<p>Note that {golem} provides you the Dockerfile you need with <code>golem::add_dockerfile()</code>.</p>
</div>
</div>
<div id="resources" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Resources</h3>
<ul>
<li><p><a href="http://r-pkgs.had.co.nz/">R packages</a></p></li>
<li><p><a href="https://speakerdeck.com/colinfay/building-a-package-that-lasts-erum-2018-workshop">“Building a package that lasts”</a></p></li>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Creating-R-packages">Writing R Extensions</a></p></li>
<li><p><a href="https://kbroman.org/pkg_primer/">R package primer - a minimal tutorial</a></p></li>
</ul>
</div>
</div>
<div id="using-shiny-modules" class="section level2">
<h2><span class="header-section-number">3.2</span> Using Shiny Modules</h2>
<p>Modules are one of the most powerful tool for building Shiny Application in a maintenable and sustainable way.</p>
<div id="why-are-we-using-shiny-modules" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Why are we using Shiny modules?</h3>
<p>Small is beautiful.
Being able to properly cut a code in small modules helps the developers to build their mental model of the application (Remember <a href="successfulshinyapp.html#complex-shiny">“What is a complex Shiny Application?”</a>).
But what are these modules?</p>
<blockquote>
<p>Shiny modules address the namespacing problem in Shiny UI and server logic, adding a level of abstraction beyond functions</p>
</blockquote>
<!--SHINY.SINGLETON[1efbbb1390b1f2da3adcc5776ac72d01ac3af14a]-->
<style>.right{ text-align: right;}</style>
<!--/SHINY.SINGLETON[1efbbb1390b1f2da3adcc5776ac72d01ac3af14a]-->
<div class="right">
<a href="https://shiny.rstudio.com/articles/modules.html">Modularizing Shiny app code</a>
</div>
<p>Let us first untangle this quote with an example about what is the Shiny namespace problem.</p>
<div id="one-million-validate-buttons" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> One million “Validate” buttons</h4>
<p>A big Shiny application usually requires to use multiple times the same pieces of ui/server connections, which makes it hard to name and identify similar inputs and outputs.</p>
<p>Indeed, Shiny requires its outputs and inputs to have a <strong>unique id</strong>.
And unfortunately, we can’t bypass that: when you send a plot <strong>from R to the browser</strong>, i.e from the <code>server</code> to the <code>ui</code>, the browser needs to know exactly where to put this element.
This “exactly where” is handled through the use of an <code>id</code>.
Ids are not a Shiny specific concept: they are at the very root of the way web pages work.
Understanding all of this is not the purpose of this chapter: just remember that Shiny inputs and outputs ids <strong>have</strong> to be unique, so that the browser knows where to put what it receives from R, and R knows what to listen to from the browser.
The need to be unique is made a little bit complex by the way Shiny handles the names, as it shares a global pool for all the id names, with no native way to use namespaces.</p>
<p>Namespaces are a computer science concept which has been designed to handle a common issue: how to share the same name for a variable in various places of your program without them conflicting.
In other words, how to use an object called <code>foo</code> several times in the program, and still be sure that it is correctly used depending on the context.
R itself has a system for namespaces ; that is what packages do and why you can have <code>purrr::flatten</code> and <code>jsonlite::flatten</code>: the function name is the same, but the two live in different namespaces.
The signification of both functions can be totally different as the symbol is evaluated inside two different namespaces.
If you want to learn more about namespaces, please refer to the <a href="https://adv-r.hadley.nz/environments.html#special-environments">7.4 Special environments</a> chapter from <em>Advanced R</em>.</p>
<p>So, that is what modules are made for: creating small namespaces where you can safely define <code>ids</code> without conflicting with other ids in the app.<br />
Why do we need to do that?<br />
Think about the number of times you created a “OK” or “validate” button.<br />
How do you handle that?<br />
By creating <code>validate1</code>, <code>validate2</code>, and so on and so forth.
And if you think about it, you are mimicking a namespacing process: a <code>validate</code> in namespace <code>1</code>, another in namespace <code>2</code>.</p>
<p>Consider the following Shiny application:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">  <span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">    <span class="kw">sliderInput</span>(</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">      <span class="dt">inputId =</span> <span class="st">&quot;choice1&quot;</span>, </a>
<a class="sourceLine" id="cb40-6" data-line-number="6">      <span class="dt">label =</span> <span class="st">&quot;choice 1&quot;</span>, </a>
<a class="sourceLine" id="cb40-7" data-line-number="7">      <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">10</span>, <span class="dt">value =</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8">    ),</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">    <span class="kw">actionButton</span>(</a>
<a class="sourceLine" id="cb40-10" data-line-number="10">      <span class="dt">inputId =</span> <span class="st">&quot;validate1&quot;</span>,</a>
<a class="sourceLine" id="cb40-11" data-line-number="11">      <span class="dt">label =</span> <span class="st">&quot;Validate choice 1&quot;</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12">    ),</a>
<a class="sourceLine" id="cb40-13" data-line-number="13">    <span class="kw">sliderInput</span>(</a>
<a class="sourceLine" id="cb40-14" data-line-number="14">      <span class="dt">inputId =</span> <span class="st">&quot;choice2&quot;</span>,</a>
<a class="sourceLine" id="cb40-15" data-line-number="15">      <span class="dt">label =</span> <span class="st">&quot;choice 2&quot;</span>, </a>
<a class="sourceLine" id="cb40-16" data-line-number="16">      <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">10</span>, <span class="dt">value =</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb40-17" data-line-number="17">    ),</a>
<a class="sourceLine" id="cb40-18" data-line-number="18">    <span class="kw">actionButton</span>(</a>
<a class="sourceLine" id="cb40-19" data-line-number="19">      <span class="dt">inputId =</span> <span class="st">&quot;validate2&quot;</span>, </a>
<a class="sourceLine" id="cb40-20" data-line-number="20">      <span class="dt">label =</span> <span class="st">&quot;Validate choice 2&quot;</span></a>
<a class="sourceLine" id="cb40-21" data-line-number="21">    )</a>
<a class="sourceLine" id="cb40-22" data-line-number="22">  )</a>
<a class="sourceLine" id="cb40-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb40-24" data-line-number="24"></a>
<a class="sourceLine" id="cb40-25" data-line-number="25">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb40-26" data-line-number="26">  <span class="kw">observeEvent</span>( input<span class="op">$</span>validate1 , {</a>
<a class="sourceLine" id="cb40-27" data-line-number="27">    <span class="kw">print</span>(input<span class="op">$</span>choice1)</a>
<a class="sourceLine" id="cb40-28" data-line-number="28">  })</a>
<a class="sourceLine" id="cb40-29" data-line-number="29">  <span class="kw">observeEvent</span>( input<span class="op">$</span>validate2 , {</a>
<a class="sourceLine" id="cb40-30" data-line-number="30">    <span class="kw">print</span>(input<span class="op">$</span>choice2)</a>
<a class="sourceLine" id="cb40-31" data-line-number="31">  })</a>
<a class="sourceLine" id="cb40-32" data-line-number="32">}</a>
<a class="sourceLine" id="cb40-33" data-line-number="33"></a>
<a class="sourceLine" id="cb40-34" data-line-number="34"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>This, of course, is an approach that works.
Well, it works as long as your code base is small.
But how can you be sure that you are not creating <code>validate6</code> on line 55 and another on line 837?
How can you be sure that you are deleting the correct combination of UI/server components if they are named that way?
Also, how do you work smoothly in a context where you have to scroll from <code>sliderInput(&quot;choice1&quot;</code> to <code>observeEvent( input$choice1 , {</code> which might be separated by thousands of lines?</p>
</div>
<div id="a-bite-sized-code-base" class="section level4">
<h4><span class="header-section-number">3.2.1.2</span> A bite-sized code base</h4>
<p>Build your application through multiple smaller application, easier to understand, develop and maintain, using shiny modules.</p>
<p>We assume that you know the R saying that <em>“if you copy and paste something more than twice, you should make a function”</em>.
Then, how do we refactor the partially repetitive piece of code so that it is reusable?</p>
<p>Yes, you guessed right: using shiny modules.
Shiny modules aim at three things: simplifying “id” namespacing, split the code base into a series of functions, and allow UI/Server parts of your app to be reused.
Most of the time, modules are used to do the two first.
In our case, we could say that 90% of the module we write are never reused<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> ; they are here to allow us to split the code base into smaller, more manageable pieces.</p>
<p>With Shiny modules, you will be writing a combination of UI and server functions.
Think of them as small, standalone Shiny apps, which output and handle a fraction of your global application.
If you develop R packages, you probably tried to split your functions into series of smaller functions.
With shiny modules, it is the exact same thing: you are, with just a little bit of tweaking, splitting your application into series of smaller applications.</p>
</div>
</div>
<div id="when-should-you-modularize" class="section level3">
<h3><span class="header-section-number">3.2.2</span> When should you modularize?</h3>
<p>We recommend you to modularise your application from the very beginning, no matter how big it is intended to be.
The overhead of writing a module compared to putting everything inside the app function is relatively low: it is even easier if you are working in a framework like <code>{golem}</code>, which promotes the use of modules from the very beginning of your application.</p>
<blockquote>
<p>&quot;Yes, but I just want to write a small app, nothing fancy</p>
</blockquote>
<p>Production apps almost always started as a small Proof Of Concept.
Then, the small POC becomes an interesting idea.
Then, this idea becomes a strategical asset.
And before you know it your ‘not-that-fancy’ app needs to become larger.
You would better build solid foundations to your application.</p>
</div>
<div id="a-practical-walk-through" class="section level3">
<h3><span class="header-section-number">3.2.3</span> A practical walk through</h3>
<p>An example is worth a thousand words. Let us explore together the code of a Shiny application split into modules.</p>
<div id="your-first-shiny-module" class="section level4">
<h4><span class="header-section-number">3.2.3.1</span> Your first Shiny Module</h4>
<p>We can transform the above example that have two sliders and two action buttons into a Shiny application with a module.
The module is small shiny application separated from the main code:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># Re-usable module</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">mod_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">    <span class="kw">sliderInput</span>(</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">      <span class="dt">inputId =</span> <span class="kw">ns</span>(<span class="st">&quot;choice&quot;</span>), </a>
<a class="sourceLine" id="cb41-7" data-line-number="7">      <span class="dt">label =</span> <span class="st">&quot;Choice&quot;</span>,</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">      <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">10</span>, <span class="dt">value =</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb41-9" data-line-number="9">    ),</a>
<a class="sourceLine" id="cb41-10" data-line-number="10">    <span class="kw">actionButton</span>(</a>
<a class="sourceLine" id="cb41-11" data-line-number="11">      <span class="dt">inputId =</span> <span class="kw">ns</span>(<span class="st">&quot;validate&quot;</span>),</a>
<a class="sourceLine" id="cb41-12" data-line-number="12">      <span class="dt">label =</span> <span class="st">&quot;Validate Choice&quot;</span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13">    )</a>
<a class="sourceLine" id="cb41-14" data-line-number="14">  )</a>
<a class="sourceLine" id="cb41-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb41-16" data-line-number="16"></a>
<a class="sourceLine" id="cb41-17" data-line-number="17">mod_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb41-18" data-line-number="18">  ns &lt;-<span class="st"> </span>session<span class="op">$</span>ns</a>
<a class="sourceLine" id="cb41-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb41-20" data-line-number="20">  <span class="kw">observeEvent</span>( input<span class="op">$</span>validate , {</a>
<a class="sourceLine" id="cb41-21" data-line-number="21">    <span class="kw">print</span>(input<span class="op">$</span>choice)</a>
<a class="sourceLine" id="cb41-22" data-line-number="22">  })</a>
<a class="sourceLine" id="cb41-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb41-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb41-25" data-line-number="25"></a>
<a class="sourceLine" id="cb41-26" data-line-number="26"><span class="co"># Main application</span></a>
<a class="sourceLine" id="cb41-27" data-line-number="27"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb41-28" data-line-number="28">app_ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb41-29" data-line-number="29">  <span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb41-30" data-line-number="30">    <span class="kw">mod_ui</span>(<span class="dt">id =</span> <span class="st">&quot;mod_ui_1&quot;</span>),</a>
<a class="sourceLine" id="cb41-31" data-line-number="31">    <span class="kw">mod_ui</span>(<span class="dt">id =</span> <span class="st">&quot;mod_ui_2&quot;</span>)</a>
<a class="sourceLine" id="cb41-32" data-line-number="32">  )</a>
<a class="sourceLine" id="cb41-33" data-line-number="33">}</a>
<a class="sourceLine" id="cb41-34" data-line-number="34"></a>
<a class="sourceLine" id="cb41-35" data-line-number="35">app_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb41-36" data-line-number="36">  <span class="kw">callModule</span>(mod_server, <span class="dt">id =</span> <span class="st">&quot;mod_ui_1&quot;</span>)</a>
<a class="sourceLine" id="cb41-37" data-line-number="37">  <span class="kw">callModule</span>(mod_server, <span class="dt">id =</span> <span class="st">&quot;mod_ui_2&quot;</span>)</a>
<a class="sourceLine" id="cb41-38" data-line-number="38">}</a>
<a class="sourceLine" id="cb41-39" data-line-number="39"></a>
<a class="sourceLine" id="cb41-40" data-line-number="40"><span class="kw">shinyApp</span>(app_ui, app_server)</a></code></pre></div>
<p>Let us stop for a minute and decompose what we have here.</p>
<p>The <strong>server</strong> function of the module (<code>mod_server()</code>) is pretty much the same as before: you use the same code as the one you would use in any server part of a Shiny application.</p>
<p>The <strong>ui</strong> function of the module (<code>mod_ui()</code>) requires specific things. There are two new things: <code>ns &lt;- NS(id)</code> and <code>ns(inputId)</code>.
That is where the namespacing happens.
Remember the previous version where you differentiated your two “validate” buttons with slightly different namespaces: <code>validate1</code> and <code>validate2</code>.
Here, we create namespaces with function <code>ns()</code> built with <code>ns &lt;- NS(id)</code>.
This line, <code>ns &lt;- NS(id)</code>, is added on top of all module ui functions and will allow building namespaces depending on the module id.
To understand what it does, let us try and run it outside of Shiny:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">id &lt;-<span class="st"> &quot;mod_ui_1&quot;</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="kw">ns</span>(<span class="st">&quot;choice&quot;</span>)</a></code></pre></div>
<pre><code>[1] &quot;mod_ui_1-choice&quot;</code></pre>
<p>And here it is, our namespaced id! With name combined with the module id.</p>
<p>Each call to a module with <code>callModule()</code> requires a different <code>id</code> argument that will allow creating various internal namespaces, preventing from id conflicts<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>.
Then you can have as many <code>validate</code> input as you want in your app, as long as this <code>validate</code> has a unique id inside your module.</p>
</div>
<div id="passing-arguments-to-your-modules" class="section level4">
<h4><span class="header-section-number">3.2.3.2</span> Passing arguments to your modules</h4>
<p>Shiny modules will potentially be reused and may need specific appearance and inputs.
This requires using extra arguments to generate the UI and server conditionally.</p>
<p>Indeed, the <strong>app_ui</strong> contains a series of call to <code>mod_ui(unique_id, ...)</code> function, allowing additional arguments like any other function:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">mod_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id, button_label) {</a>
<a class="sourceLine" id="cb44-2" data-line-number="2">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">    <span class="kw">actionButton</span>(<span class="kw">ns</span>(<span class="st">&quot;validate&quot;</span>), button_label)</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb44-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb44-7" data-line-number="7"></a>
<a class="sourceLine" id="cb44-8" data-line-number="8"><span class="kw">mod_ui</span>(<span class="st">&quot;mod_ui_1&quot;</span>, <span class="dt">button_label =</span> <span class="st">&quot;Validate Choice&quot;</span>)</a>
<a class="sourceLine" id="cb44-9" data-line-number="9"><span class="kw">mod_ui</span>(<span class="st">&quot;mod_ui_2&quot;</span>, <span class="dt">button_label =</span> <span class="st">&quot;Validate Choice, again&quot;</span>)</a></code></pre></div>
<pre><code>&lt;button id=&quot;mod_ui_1-validate&quot; type=&quot;button&quot; class=&quot;btn btn-default action-button&quot;&gt;Validate Choice&lt;/button&gt;

&lt;button id=&quot;mod_ui_2-validate&quot; type=&quot;button&quot; class=&quot;btn btn-default action-button&quot;&gt;Validate Choice, again&lt;/button&gt;</code></pre>
<p>The <strong>app_server</strong> side contains a series of <code>callModule(mod_server, unique_id, ...)</code>, also allowing additional arguments like any other function.</p>
<p>As a live example, we can have a look at <a href="https://github.com/ColinFay/tidytuesday201942/blob/master/R/mod_dataviz.R#L17">mod_dataviz.R</a> from the <code>{tidytuesday201942}</code> Shiny application.</p>
<p>This application contains 6 tabs, 4 of them being pretty much alike: a side bar with inputs, an a main panel with a button and the plot.
This is a typical case where you should reuse modules: if two or more parts are relatively similar, it is easier to bundle it inside a reusable module, and condition the ui/server with function arguments.</p>
<p><img src="img/tidytuesdayapp.png" /></p>
<p>Here, are some examples of how it works in the module UI:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">mod_dataviz_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id, </a>
<a class="sourceLine" id="cb46-2" data-line-number="2">                           <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;hist&quot;</span>, <span class="st">&quot;boxplot&quot;</span>, <span class="st">&quot;bar&quot;</span>)) {</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">  <span class="kw">h4</span>(</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">    <span class="kw">sprintf</span>( <span class="st">&quot;Create a geom_%s&quot;</span>, type )</a>
<a class="sourceLine" id="cb46-5" data-line-number="5">  ),</a>
<a class="sourceLine" id="cb46-6" data-line-number="6">  <span class="cf">if</span> (type <span class="op">==</span><span class="st"> &quot;boxplot&quot;</span> <span class="op">|</span><span class="st"> </span>type <span class="op">==</span><span class="st">&quot;bar&quot;</span>) {</a>
<a class="sourceLine" id="cb46-7" data-line-number="7">    <span class="kw">selectInput</span>(</a>
<a class="sourceLine" id="cb46-8" data-line-number="8">      <span class="kw">ns</span>(<span class="st">&quot;x&quot;</span>),</a>
<a class="sourceLine" id="cb46-9" data-line-number="9">      <span class="st">&quot;x&quot;</span>, </a>
<a class="sourceLine" id="cb46-10" data-line-number="10">      <span class="dt">choices =</span> <span class="kw">names_that_are</span>(<span class="kw">c</span>(<span class="st">&quot;logical&quot;</span>, <span class="st">&quot;character&quot;</span>))</a>
<a class="sourceLine" id="cb46-11" data-line-number="11">    )</a>
<a class="sourceLine" id="cb46-12" data-line-number="12">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb46-13" data-line-number="13">    <span class="kw">selectInput</span>(</a>
<a class="sourceLine" id="cb46-14" data-line-number="14">      <span class="kw">ns</span>(<span class="st">&quot;x&quot;</span>),</a>
<a class="sourceLine" id="cb46-15" data-line-number="15">      <span class="st">&quot;x&quot;</span>, </a>
<a class="sourceLine" id="cb46-16" data-line-number="16">      <span class="dt">choices =</span> <span class="kw">names_that_are</span>(<span class="st">&quot;numeric&quot;</span>)</a>
<a class="sourceLine" id="cb46-17" data-line-number="17">    )</a>
<a class="sourceLine" id="cb46-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb46-19" data-line-number="19">}</a></code></pre></div>
<p>And in the module server:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1">mod_dataviz_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session, type) {</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">  <span class="cf">if</span> (type <span class="op">==</span><span class="st"> &quot;point&quot;</span>) {</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">    x &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw">sym</span>(input<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">    y &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw">sym</span>(input<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">    color &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw">sym</span>(input<span class="op">$</span>color)</a>
<a class="sourceLine" id="cb47-6" data-line-number="6">    r<span class="op">$</span>plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(</a>
<a class="sourceLine" id="cb47-7" data-line-number="7">      big_epa_cars, </a>
<a class="sourceLine" id="cb47-8" data-line-number="8">      <span class="kw">aes</span>(<span class="op">!!</span>x, <span class="op">!!</span>y, <span class="dt">color =</span> <span class="op">!!</span>color)</a>
<a class="sourceLine" id="cb47-9" data-line-number="9">    )  <span class="op">+</span></a>
<a class="sourceLine" id="cb47-10" data-line-number="10"><span class="st">      </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-11" data-line-number="11"><span class="st">      </span><span class="kw">scale_color_manual</span>(</a>
<a class="sourceLine" id="cb47-12" data-line-number="12">        <span class="dt">values =</span> <span class="kw">color_values</span>(</a>
<a class="sourceLine" id="cb47-13" data-line-number="13">          <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(<span class="kw">pull</span>(big_epa_cars, <span class="op">!!</span>color))), </a>
<a class="sourceLine" id="cb47-14" data-line-number="14">          <span class="dt">palette =</span> input<span class="op">$</span>palette</a>
<a class="sourceLine" id="cb47-15" data-line-number="15">        )</a>
<a class="sourceLine" id="cb47-16" data-line-number="16">      )</a>
<a class="sourceLine" id="cb47-17" data-line-number="17">  } </a>
<a class="sourceLine" id="cb47-18" data-line-number="18">}</a></code></pre></div>
<p>Then, the UI of the entire application is:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">app_ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">  <span class="co"># [...]</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">    <span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb48-5" data-line-number="5">      <span class="dt">id =</span> <span class="st">&quot;geom_point&quot;</span>, <span class="kw">mod_dataviz_ui</span>(<span class="st">&quot;dataviz_ui_1&quot;</span>, <span class="st">&quot;point&quot;</span>)</a>
<a class="sourceLine" id="cb48-6" data-line-number="6">    ), </a>
<a class="sourceLine" id="cb48-7" data-line-number="7">    <span class="kw">fluidRow</span>(</a>
<a class="sourceLine" id="cb48-8" data-line-number="8">      <span class="dt">id =</span> <span class="st">&quot;geom_hist&quot;</span>, <span class="kw">mod_dataviz_ui</span>(<span class="st">&quot;dataviz_ui_2&quot;</span>, <span class="st">&quot;hist&quot;</span>)</a>
<a class="sourceLine" id="cb48-9" data-line-number="9">    )</a>
<a class="sourceLine" id="cb48-10" data-line-number="10">  )</a>
<a class="sourceLine" id="cb48-11" data-line-number="11">}</a></code></pre></div>
<p>And the <code>app_server()</code> of the application:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1">app_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">  <span class="co">#callModule(mod_raw_server, &quot;raw_ui_1&quot;)</span></a>
<a class="sourceLine" id="cb49-3" data-line-number="3">  <span class="kw">callModule</span>(mod_dataviz_server, <span class="st">&quot;dataviz_ui_1&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;point&quot;</span>)</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">  <span class="kw">callModule</span>(mod_dataviz_server, <span class="st">&quot;dataviz_ui_2&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>)</a>
<a class="sourceLine" id="cb49-5" data-line-number="5">  <span class="kw">callModule</span>(mod_dataviz_server, <span class="st">&quot;dataviz_ui_3&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>)</a>
<a class="sourceLine" id="cb49-6" data-line-number="6">  <span class="kw">callModule</span>(mod_dataviz_server, <span class="st">&quot;dataviz_ui_4&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;bar&quot;</span>)</a>
<a class="sourceLine" id="cb49-7" data-line-number="7">}</a></code></pre></div>
</div>
</div>
<div id="communication-between-modules" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Communication between modules</h3>
<p>One of the hardest part about modules is sharing data across them.
There are at least three approaches: (i) returning <code>reactive</code>, (ii) the “stratégie du petit r” (to be pronounced with a french accent) or (iii) the “stratégie du grand R6”.</p>
<div id="returning-values-from-the-module" class="section level4">
<h4><span class="header-section-number">3.2.4.1</span> Returning values from the module</h4>
<p>One common approach is to return a <code>reactive</code> from one module, and pass it to another, in the general <code>app_server()</code> function.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># Module 1</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">mod_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb50-3" data-line-number="3">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb50-4" data-line-number="4">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb50-5" data-line-number="5">    <span class="kw">sliderInput</span>(<span class="kw">ns</span>(<span class="st">&quot;choice&quot;</span>), <span class="st">&quot;Choice&quot;</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"></a>
<a class="sourceLine" id="cb50-9" data-line-number="9">mod_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb50-10" data-line-number="10">  <span class="kw">return</span>(</a>
<a class="sourceLine" id="cb50-11" data-line-number="11">    <span class="kw">reactive</span>({</a>
<a class="sourceLine" id="cb50-12" data-line-number="12">      input<span class="op">$</span>choice</a>
<a class="sourceLine" id="cb50-13" data-line-number="13">    })</a>
<a class="sourceLine" id="cb50-14" data-line-number="14">  )</a>
<a class="sourceLine" id="cb50-15" data-line-number="15">}</a>
<a class="sourceLine" id="cb50-16" data-line-number="16"></a>
<a class="sourceLine" id="cb50-17" data-line-number="17"><span class="co"># Module 2</span></a>
<a class="sourceLine" id="cb50-18" data-line-number="18">mod_b_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb50-19" data-line-number="19">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb50-20" data-line-number="20">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb50-21" data-line-number="21">    <span class="kw">actionButton</span>(<span class="kw">ns</span>(<span class="st">&quot;validate&quot;</span>), <span class="st">&quot;Print&quot;</span>)</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">  )</a>
<a class="sourceLine" id="cb50-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb50-24" data-line-number="24"></a>
<a class="sourceLine" id="cb50-25" data-line-number="25">mod_b_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session, react) {</a>
<a class="sourceLine" id="cb50-26" data-line-number="26">  <span class="kw">observeEvent</span>( input<span class="op">$</span>validate , {</a>
<a class="sourceLine" id="cb50-27" data-line-number="27">    <span class="kw">print</span>(<span class="kw">react</span>())</a>
<a class="sourceLine" id="cb50-28" data-line-number="28">  })</a>
<a class="sourceLine" id="cb50-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb50-30" data-line-number="30"></a>
<a class="sourceLine" id="cb50-31" data-line-number="31"><span class="co"># Application</span></a>
<a class="sourceLine" id="cb50-32" data-line-number="32"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb50-33" data-line-number="33">app_ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb50-34" data-line-number="34">  <span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb50-35" data-line-number="35">    <span class="kw">mod_ui</span>(<span class="st">&quot;mod_ui_1&quot;</span>),</a>
<a class="sourceLine" id="cb50-36" data-line-number="36">    <span class="kw">mod_b_ui</span>(<span class="st">&quot;mod_ui_2&quot;</span>)</a>
<a class="sourceLine" id="cb50-37" data-line-number="37">  )</a>
<a class="sourceLine" id="cb50-38" data-line-number="38">}</a>
<a class="sourceLine" id="cb50-39" data-line-number="39"></a>
<a class="sourceLine" id="cb50-40" data-line-number="40">app_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb50-41" data-line-number="41">  res &lt;-<span class="st"> </span><span class="kw">callModule</span>(mod_server, <span class="st">&quot;mod_ui_1&quot;</span>)</a>
<a class="sourceLine" id="cb50-42" data-line-number="42">  <span class="kw">callModule</span>(mod_b_server, <span class="st">&quot;mod_ui_2&quot;</span>, <span class="dt">react =</span> res)</a>
<a class="sourceLine" id="cb50-43" data-line-number="43">}</a>
<a class="sourceLine" id="cb50-44" data-line-number="44"></a>
<a class="sourceLine" id="cb50-45" data-line-number="45"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>This strategy works well, but for large Shiny Apps it might be hard to handle large list of reactive outputs / inputs.
It might also create some reactivity issues, as a lot of <code>reactive</code> is harder to control.</p>
</div>
<div id="the-stratégie-du-petit-r" class="section level4">
<h4><span class="header-section-number">3.2.4.2</span> The “stratégie du petit r”</h4>
<p>In this strategy, we create a global <code>reactive</code> list that is passed along other modules.
The idea is that it allows us to be less preoccupied about what your module takes as input.
Below, we create a “global” <code>reactiveValues()</code> object in the <code>app_server()</code> function.
It will pass through all modules, where it is named <code>r</code> inside each module server function.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="co"># Module 1</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2">mod_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb51-4" data-line-number="4">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb51-5" data-line-number="5">    <span class="kw">sliderInput</span>(<span class="kw">ns</span>(<span class="st">&quot;choice&quot;</span>), <span class="st">&quot;Choice&quot;</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb51-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb51-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb51-8" data-line-number="8"></a>
<a class="sourceLine" id="cb51-9" data-line-number="9">mod_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session, r) {</a>
<a class="sourceLine" id="cb51-10" data-line-number="10">  <span class="kw">observeEvent</span>( input<span class="op">$</span>choice , {</a>
<a class="sourceLine" id="cb51-11" data-line-number="11">    r<span class="op">$</span>choice &lt;-<span class="st"> </span>input<span class="op">$</span>choice</a>
<a class="sourceLine" id="cb51-12" data-line-number="12">  })</a>
<a class="sourceLine" id="cb51-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb51-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb51-15" data-line-number="15"></a>
<a class="sourceLine" id="cb51-16" data-line-number="16"><span class="co"># Module 2</span></a>
<a class="sourceLine" id="cb51-17" data-line-number="17">mod_b_ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb51-18" data-line-number="18">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb51-19" data-line-number="19">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb51-20" data-line-number="20">    <span class="kw">actionButton</span>(<span class="kw">ns</span>(<span class="st">&quot;validate&quot;</span>), <span class="st">&quot;Print&quot;</span>)</a>
<a class="sourceLine" id="cb51-21" data-line-number="21">  )</a>
<a class="sourceLine" id="cb51-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb51-23" data-line-number="23"></a>
<a class="sourceLine" id="cb51-24" data-line-number="24">mod_b_server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session, r) {</a>
<a class="sourceLine" id="cb51-25" data-line-number="25">  ns &lt;-<span class="st"> </span>session<span class="op">$</span>ns</a>
<a class="sourceLine" id="cb51-26" data-line-number="26">  <span class="kw">observeEvent</span>( input<span class="op">$</span>validate , {</a>
<a class="sourceLine" id="cb51-27" data-line-number="27">    <span class="kw">print</span>(r<span class="op">$</span>choice)</a>
<a class="sourceLine" id="cb51-28" data-line-number="28">  })</a>
<a class="sourceLine" id="cb51-29" data-line-number="29">  </a>
<a class="sourceLine" id="cb51-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb51-31" data-line-number="31"></a>
<a class="sourceLine" id="cb51-32" data-line-number="32"><span class="co"># Application</span></a>
<a class="sourceLine" id="cb51-33" data-line-number="33"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb51-34" data-line-number="34">ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb51-35" data-line-number="35">  <span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb51-36" data-line-number="36">    <span class="kw">mod_ui</span>(<span class="st">&quot;mod_ui_1&quot;</span>),</a>
<a class="sourceLine" id="cb51-37" data-line-number="37">    <span class="kw">mod_b_ui</span>(<span class="st">&quot;mod_ui_2&quot;</span>)</a>
<a class="sourceLine" id="cb51-38" data-line-number="38">  )</a>
<a class="sourceLine" id="cb51-39" data-line-number="39">}</a>
<a class="sourceLine" id="cb51-40" data-line-number="40"></a>
<a class="sourceLine" id="cb51-41" data-line-number="41">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb51-42" data-line-number="42">  r &lt;-<span class="st"> </span><span class="kw">reactiveValues</span>()</a>
<a class="sourceLine" id="cb51-43" data-line-number="43">  <span class="kw">callModule</span>(mod_server, <span class="st">&quot;mod_ui_1&quot;</span>, r)</a>
<a class="sourceLine" id="cb51-44" data-line-number="44">  <span class="kw">callModule</span>(mod_b_server, <span class="st">&quot;mod_ui_2&quot;</span>, r)</a>
<a class="sourceLine" id="cb51-45" data-line-number="45">}</a>
<a class="sourceLine" id="cb51-46" data-line-number="46"></a>
<a class="sourceLine" id="cb51-47" data-line-number="47"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>The interest of this method is that whenever you add something in one module, it is immediately available in the other modules.
The downside is that it can be harder to reason about the app, as the input / content of the <code>r</code> is not specified anywhere: as you do not pass any arguments to your function other than <code>r</code>, you do not really know what is inside.</p>
<p>Note that if you want to share your module, for example in a package, you should document the structure of the <code>r</code>.
For example:</p>
<pre><code>#&#39; @param r a `reactiveValues()` with a `choice` element in it. 
#&#39; This `r$choice` will be printed to the R console.</code></pre>
</div>
<div id="the-stratégie-du-grand-r6" class="section level4">
<h4><span class="header-section-number">3.2.4.3</span> The “stratégie du grand R6”</h4>
<p>Similarly to the “stratégie du petit r”, we can create an R6 object which is pass along the modules. This R6 object is not a reactive object, making it more robust to the complexity of handling reactivity invalidation across modules.</p>
<p>This methods is explained in details in chapter <a href="optim-caveat.html#optim-caveat">Reactivity anti-patterns</a> of this book.</p>
</div>
</div>
</div>
<div id="structuring-your-app" class="section level2">
<h2><span class="header-section-number">3.3</span> Structuring your app</h2>
<div id="business-logic-application-logic" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Business logic &amp; application logic</h3>
<p>A shiny application has two main components: the application logic and the business logic.</p>
<ul>
<li><p>Application logic is what makes your Shiny app interactive: structure, button, table, interactivity, etc.
This component is not specific to your core business: you could use it for any other line of work or professional context.
This has no other use case than your interactive application: it is not meant to be used outside your app, in a static report for instance.</p></li>
<li><p>Business logic is the components with the core algorithms and functions that make your application specific to your area of work.
You can recognize this component as the one that can be run outside any interactive context.
This is the case for specific computation and algorithm, custom plot or <code>geom</code> for <code>{ggplot2}</code>, specific calls to a database, etc.</p></li>
</ul>
<p>These two components do not have to live together.
They should not live together if you want to keep your sanity when you build an app.</p>
<blockquote>
<p>You will end up having to rerun the app from scratch and spend five minutes clicking everywhere just to be sure you have correctly set the color palette for the graph on the last <code>tabPanel()</code>.</p>
</blockquote>
<p>Trust us, we have been there, and it is not pretty.</p>
<p>So what is the way to go?
Extract the business function from the reactive functions.
Literally.
Compare this pattern:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># Application</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb53-4" data-line-number="4">ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb53-5" data-line-number="5">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb53-6" data-line-number="6">    <span class="kw">tableOutput</span>(<span class="st">&quot;tbl&quot;</span>)</a>
<a class="sourceLine" id="cb53-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb53-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb53-9" data-line-number="9"></a>
<a class="sourceLine" id="cb53-10" data-line-number="10">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb53-11" data-line-number="11">  output<span class="op">$</span>tbl &lt;-<span class="st"> </span><span class="kw">renderTable</span>({</a>
<a class="sourceLine" id="cb53-12" data-line-number="12">    mtcars <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb53-13" data-line-number="13"><span class="st">      </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb53-14" data-line-number="14"><span class="st">      </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb53-15" data-line-number="15"><span class="st">      </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb53-16" data-line-number="16"><span class="st">      </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb53-17" data-line-number="17"><span class="st">      </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb53-18" data-line-number="18"><span class="st">      </span><span class="kw">top_n</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb53-19" data-line-number="19">  })</a>
<a class="sourceLine" id="cb53-20" data-line-number="20">}</a>
<a class="sourceLine" id="cb53-21" data-line-number="21"></a>
<a class="sourceLine" id="cb53-22" data-line-number="22"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>To this one:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb54-3" data-line-number="3"></a>
<a class="sourceLine" id="cb54-4" data-line-number="4"><span class="co"># Business logic</span></a>
<a class="sourceLine" id="cb54-5" data-line-number="5">top_this &lt;-<span class="st"> </span><span class="cf">function</span>(tbl) {</a>
<a class="sourceLine" id="cb54-6" data-line-number="6">  tbl <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb54-7" data-line-number="7"><span class="st">    </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb54-8" data-line-number="8"><span class="st">    </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb54-9" data-line-number="9"><span class="st">    </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb54-10" data-line-number="10"><span class="st">    </span><span class="co"># [...] %&gt;% </span></a>
<a class="sourceLine" id="cb54-11" data-line-number="11"><span class="st">    </span><span class="kw">top_n</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb54-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb54-13" data-line-number="13"></a>
<a class="sourceLine" id="cb54-14" data-line-number="14"><span class="co"># Application</span></a>
<a class="sourceLine" id="cb54-15" data-line-number="15">ui &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb54-16" data-line-number="16">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb54-17" data-line-number="17">    <span class="kw">tableOutput</span>(<span class="st">&quot;tbl&quot;</span>)</a>
<a class="sourceLine" id="cb54-18" data-line-number="18">  )</a>
<a class="sourceLine" id="cb54-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb54-20" data-line-number="20"></a>
<a class="sourceLine" id="cb54-21" data-line-number="21">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb54-22" data-line-number="22">  output<span class="op">$</span>tbl &lt;-<span class="st"> </span><span class="kw">renderTable</span>({</a>
<a class="sourceLine" id="cb54-23" data-line-number="23">    <span class="kw">top_this</span>(mtcars)</a>
<a class="sourceLine" id="cb54-24" data-line-number="24">  })</a>
<a class="sourceLine" id="cb54-25" data-line-number="25">}</a>
<a class="sourceLine" id="cb54-26" data-line-number="26"></a>
<a class="sourceLine" id="cb54-27" data-line-number="27"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
<p>Both scripts do the exact same thing.
The difference is that the second code can be easily explored without having to relaunch the app.
You will be able to build a reproducible example to explore, illustrate and improve function named <code>top_this()</code>.
This function can be tested, documented and reused outside the application.
Moreover, this approach lowers the cognitive load when debugging: you either debug an application issue, or a business logic issue.
You never debug both types of issues at the same time.
For the your mental reprsentation, we recommend to put functions of the two logics in separate files, module in a file, util functions in an other.
If you want to be even more strict about this, you can write a package for these functions, so that they are neatly separated from the package containing the Shiny application.</p>
</div>
<div id="small-is-beautiful-bis-repetita" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Small is beautiful (bis repetita)</h3>
<p>There are a lot of reasons for splitting your application into smaller pieces: it is easier to maintain, easier to decipher, and it facilitates collaboration.</p>
<p>There is nothing harder to maintain than a Shiny app only made of a unique 1000-lines long <code>app.R</code> file.
Well, there still is the 10000-lines long <code>app.R</code> file, but you got the idea.
Long scripts are almost always synonym of complexity when it comes to building an application.
Of course, small and numerous scripts do not systematically prevent from codebase complexity but they simplify collaboration and maintenance, and divide the application logic into smaller, easier to understand bits of code.</p>
<p>So yes, big files are complex to handle and make development harder.
Indeed, here is what happens when you work on a application for production:</p>
<ul>
<li><p>You will work during a long period of time (either in one run or split across several months) on your codebase. Hence, you will have to get back to pieces of code you wrote a long time ago.</p></li>
<li>You will possibly develop with other developers.
Maintaining a code base when several people work on the same directory is already a complex thing: from time to time you might work on the same file separately, a situation where you will have to be careful about what and how you merge things when changes are implemented.
It is almost impossible to work together on one same file all along the project without losing your mind: even more if this file is thousands of lines long.</li>
<li><p>You will implement numerous features.
Numerous features imply a lot of UI &amp; server interactions.
In an <code>app.R</code> file of thousands lines, it is very hard to match the UI element with its server counterpart: when the UI is on line 50 and the server on line 570, you will be scrolling a lot when working on that element.</p></li>
</ul>
</div>
<div id="conventions-matter" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Conventions matter</h3>
<p>We propose a naming convention for your app files and functions so that you and your collaborators will not get lost with the multiple pieces of your code.</p>
<p>Splitting files is good.
Splitting files using a defined convention is better.
Why?
Because using a common convention for your files helps the other developers (and potentially you) to know exactly what is contained in a specific file.
That way, it helps everyone know where to look for debugging / implementing new features.
For example, if you follow <code>{golem}</code>’s convention, you will know that a file starting with <code>mod_</code> contains a module. If I take over a project, look in the <code>R/</code> folder and see files starting with these three letters, I will know immediately that these files contain Shiny modules.</p>
<p>Here is our proposition for a convention on how to split your application into smaller pieces.</p>
<p>First of all, put everything into an <code>R/</code> folder.
If you build your app using the <code>{golem}</code> framework, this is already the case.
We use the package convention to hold the functions of our application.</p>
<p>The naming convention in <code>{golem}</code> is the following:</p>
<ul>
<li><p><code>app_*.R</code> (typically <code>app_ui.R</code> and <code>app_server.R</code>) contain the top level functions defining your user interface and your server function.</p></li>
<li><p><code>fct_*</code> files contains the business logic, potentially large functions.
They are the backbone of the application but may not be specific to a given module.
They can be added using <code>{golem}</code> with the <code>add_fct(&quot;name&quot;)</code> function.</p></li>
<li><p><code>mod_*</code> files contain a unique module.
As many shiny apps contain a series of tabs, or at least a tab-like pattern, we suggest that you number then according to their step in the application.
Tabs are almost always named in the user interface, so that you can use this tab-name as the file name.
For example, if you build a dashboard where the first tab is called “Import”, your should name your file <code>mod_01_import.R</code>.
You can create this file with a module skeleton using <code>golem::add_module(&quot;01_import&quot;)</code>.</p></li>
<li><p><code>utils_*</code> are files that contain utilities, which are small helper functions.
For example, you might want to have a <code>not_na</code>, which is <code>not_na &lt;- Negate(is.na)</code>, a <code>not_null</code>, or small tools that you will be using application-wide.
Note that you can also create <code>utils</code> for a specific module.</p></li>
<li><p><code>*_ui_*</code>, for example <code>utils_ui.R</code>, relates to the user interface.
Anything back-end can be noted using <code>*_server_*</code>, for example <code>fct_connection_server.R</code> will contain functions that are related to the connection to a database, and which are specifically used from the server side.</p></li>
</ul>
<p>Note that when building a module file with <code>{golem}</code>, you can also create <code>fct_</code> and <code>utils_</code> specific files that will hold functions and utilities for this specific module.
For example, <code>golem::add_module(&quot;01_import&quot;, fct = &quot;readr&quot;, utils = &quot;ui&quot;)</code> will create <code>R/mod_01_import.R</code>, <code>R/mod_01_import_fct_readr.R</code> and <code>R/mod_01_import_utils_ui.R</code>.</p>
<p>Of course, as with any convention, you might be deviating from time to time from this pattern.
Your app may not have that many functions, or maybe the functions can all fit into one <code>utils_</code> file.
But be it one or thousands of files, it is always a good practice to stick to a formalized pattern.</p>

</div>
</div>
</div>
<hr/>
<footer>
<a href="rtask.thinkr.fr"><img src="img/logo400_129.png" alt="ThinkR Website"/></a>
</footer>
            </section>

          </div>
        </div>
      </div>
<a href="planning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="golem.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ThinkR-open/building-shiny-apps-workflow/edit/master/structure.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["engineering-production-grade-shiny-apps.pdf", "engineering-production-grade-shiny-apps.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
